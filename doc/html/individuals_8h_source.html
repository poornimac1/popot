<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>popot-1.21: /opt/GoogleCode/popot/trunk/popot-1.21/src/individuals.h Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">popot-1.21
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div class="header">
  <div class="headertitle">
<div class="title">/opt/GoogleCode/popot/trunk/popot-1.21/src/individuals.h</div>  </div>
</div>
<div class="contents">
<a href="individuals_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef POPOT_INDIVIDUALS_H</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define POPOT_INDIVIDUALS_H</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;iostream&gt;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &lt;cmath&gt;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &lt;cstdlib&gt;</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;cstring&gt;</span>
<a name="l00008"></a>00008 
<a name="l00009"></a>00009 <span class="preprocessor">#include &quot;<a class="code" href="maths_8h.html">maths.h</a>&quot;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &quot;<a class="code" href="neighborhood_8h.html">neighborhood.h</a>&quot;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &quot;<a class="code" href="exceptions_8h.html">exceptions.h</a>&quot;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;<a class="code" href="tools_8h.html">tools.h</a>&quot;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;<a class="code" href="initializers_8h.html">initializers.h</a>&quot;</span>
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 <span class="comment">// For particle param values see</span>
<a name="l00016"></a>00016 <span class="comment">// For standard PSO </span>
<a name="l00017"></a>00017 <span class="comment">// Clerc, M., et al.: Standard PSO 2007</span>
<a name="l00018"></a>00018 <span class="comment">// Bratton, D., Kennedy, J.: Defining a Standard for Particle Swarm Optimization.</span>
<a name="l00019"></a>00019 
<a name="l00020"></a>00020 <span class="keyword">namespace </span>popot
<a name="l00021"></a>00021 {
<a name="l00022"></a>00022 
<a name="l00028"></a>00028   <span class="keyword">template</span>&lt; <span class="keyword">typename</span> VALUE_TYPE, <span class="keywordtype">int</span> SIZE&gt;
<a name="l00029"></a>00029     <span class="keyword">class </span>Vector
<a name="l00030"></a>00030   {
<a name="l00031"></a>00031   <span class="keyword">protected</span>:
<a name="l00032"></a><a class="code" href="classpopot_1_1Vector.html#a5ee50f0b32911dd48766137eee1dfc41">00032</a>     VALUE_TYPE * <a class="code" href="classpopot_1_1Vector.html#a5ee50f0b32911dd48766137eee1dfc41">values</a>;
<a name="l00033"></a><a class="code" href="classpopot_1_1Vector.html#abc626ed335de72ae1178d448dffb4f5d">00033</a>     <span class="keywordtype">int</span> <a class="code" href="classpopot_1_1Vector.html#abc626ed335de72ae1178d448dffb4f5d">dimension</a>;
<a name="l00034"></a>00034       
<a name="l00035"></a>00035   <span class="keyword">public</span>:
<a name="l00036"></a>00036 
<a name="l00040"></a><a class="code" href="classpopot_1_1Vector.html#a10db4d32978788f19aeb930ae7c7ba9c">00040</a>     <a class="code" href="classpopot_1_1Vector.html#a10db4d32978788f19aeb930ae7c7ba9c">Vector</a>(<span class="keywordtype">void</span>)
<a name="l00041"></a>00041       {
<a name="l00042"></a>00042         <a class="code" href="classpopot_1_1Vector.html#a5ee50f0b32911dd48766137eee1dfc41">values</a> = <span class="keyword">new</span> VALUE_TYPE[SIZE];
<a name="l00043"></a>00043         <a class="code" href="classpopot_1_1Vector.html#abc626ed335de72ae1178d448dffb4f5d">dimension</a> = SIZE;
<a name="l00044"></a>00044       }
<a name="l00045"></a>00045 
<a name="l00049"></a><a class="code" href="classpopot_1_1Vector.html#a6de5f7bc7288d6b2efc3e5b135f166e7">00049</a>     <a class="code" href="classpopot_1_1Vector.html#a10db4d32978788f19aeb930ae7c7ba9c">Vector</a>(<span class="keyword">const</span> <a class="code" href="classpopot_1_1Vector.html" title="The template parameters are the type of values (e.g. double, or bool) and the dimension of the vector...">Vector</a>&amp; other)
<a name="l00050"></a>00050       {
<a name="l00051"></a>00051         <a class="code" href="classpopot_1_1Vector.html#a5ee50f0b32911dd48766137eee1dfc41">values</a> = <span class="keyword">new</span> VALUE_TYPE[SIZE];
<a name="l00052"></a>00052         <a class="code" href="classpopot_1_1Vector.html#abc626ed335de72ae1178d448dffb4f5d">dimension</a> = SIZE;
<a name="l00053"></a>00053         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1Vector.html#abc626ed335de72ae1178d448dffb4f5d">dimension</a> ; ++i)
<a name="l00054"></a>00054           <a class="code" href="classpopot_1_1Vector.html#a5ee50f0b32911dd48766137eee1dfc41">values</a>[i] = other.values[i];
<a name="l00055"></a>00055       }
<a name="l00056"></a>00056       
<a name="l00057"></a>00057 
<a name="l00061"></a><a class="code" href="classpopot_1_1Vector.html#a512e762c4f86b77533513bd7b429a27f">00061</a>     <a class="code" href="classpopot_1_1Vector.html" title="The template parameters are the type of values (e.g. double, or bool) and the dimension of the vector...">Vector</a> &amp; <a class="code" href="classpopot_1_1Vector.html#a512e762c4f86b77533513bd7b429a27f">operator=</a>(<span class="keyword">const</span> <a class="code" href="classpopot_1_1Vector.html" title="The template parameters are the type of values (e.g. double, or bool) and the dimension of the vector...">Vector</a>&amp; other)
<a name="l00062"></a>00062       {
<a name="l00063"></a>00063         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1Vector.html#abc626ed335de72ae1178d448dffb4f5d">dimension</a> ; ++i)
<a name="l00064"></a>00064           <a class="code" href="classpopot_1_1Vector.html#a5ee50f0b32911dd48766137eee1dfc41">values</a>[i] = other.values[i];
<a name="l00065"></a>00065 
<a name="l00066"></a>00066         <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00067"></a>00067       }
<a name="l00068"></a>00068 
<a name="l00069"></a>00069 
<a name="l00073"></a><a class="code" href="classpopot_1_1Vector.html#ab96675e080080246554a2579fde88032">00073</a>     <span class="keyword">virtual</span> <a class="code" href="classpopot_1_1Vector.html#ab96675e080080246554a2579fde88032">~Vector</a>(<span class="keywordtype">void</span>)
<a name="l00074"></a>00074       {
<a name="l00075"></a>00075         <span class="keyword">delete</span>[] <a class="code" href="classpopot_1_1Vector.html#a5ee50f0b32911dd48766137eee1dfc41">values</a>;
<a name="l00076"></a>00076         <a class="code" href="classpopot_1_1Vector.html#a5ee50f0b32911dd48766137eee1dfc41">values</a> = 0;
<a name="l00077"></a>00077       }
<a name="l00078"></a>00078 
<a name="l00079"></a>00079 
<a name="l00085"></a><a class="code" href="classpopot_1_1Vector.html#a1df5ea1f345af90326a85e566b25d0e5">00085</a>     <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1Vector.html#a1df5ea1f345af90326a85e566b25d0e5">setValueAt</a>(<span class="keywordtype">int</span> index, VALUE_TYPE value)
<a name="l00086"></a>00086     {
<a name="l00087"></a>00087       <a class="code" href="classpopot_1_1Vector.html#a5ee50f0b32911dd48766137eee1dfc41">values</a>[index] = value;
<a name="l00088"></a>00088     }
<a name="l00089"></a>00089 
<a name="l00094"></a><a class="code" href="classpopot_1_1Vector.html#aefbef7f1d1b43f53aac6e2d717feb618">00094</a>     VALUE_TYPE <a class="code" href="classpopot_1_1Vector.html#aefbef7f1d1b43f53aac6e2d717feb618">getValueAt</a>(<span class="keywordtype">int</span> index)<span class="keyword"> const</span>
<a name="l00095"></a>00095 <span class="keyword">    </span>{
<a name="l00096"></a>00096       <span class="keywordflow">if</span>(index &gt;= 0 &amp;&amp; index &lt; SIZE)
<a name="l00097"></a>00097         <span class="keywordflow">return</span> <a class="code" href="classpopot_1_1Vector.html#a5ee50f0b32911dd48766137eee1dfc41">values</a>[index];
<a name="l00098"></a>00098       <span class="keywordflow">else</span>
<a name="l00099"></a>00099         <span class="keywordflow">throw</span> <a class="code" href="classpopot_1_1Exception_1_1IndexOutOfRange.html">popot::Exception::IndexOutOfRange</a>(index, SIZE);
<a name="l00100"></a>00100     }
<a name="l00101"></a>00101 
<a name="l00105"></a><a class="code" href="classpopot_1_1Vector.html#ad1802400de981925055e8ce885d41f01">00105</a>     <span class="keywordtype">int</span> <a class="code" href="classpopot_1_1Vector.html#ad1802400de981925055e8ce885d41f01">size</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00106"></a>00106 <span class="keyword">    </span>{
<a name="l00107"></a>00107       <span class="keywordflow">return</span> SIZE;
<a name="l00108"></a>00108     }
<a name="l00109"></a>00109 
<a name="l00113"></a><a class="code" href="classpopot_1_1Vector.html#aa74fc0320c51efea093baeafb62a9c21">00113</a>     VALUE_TYPE * <a class="code" href="classpopot_1_1Vector.html#aa74fc0320c51efea093baeafb62a9c21">getValuesPtr</a>(<span class="keywordtype">void</span>)
<a name="l00114"></a>00114     {
<a name="l00115"></a>00115       <span class="keywordflow">return</span> <a class="code" href="classpopot_1_1Vector.html#a5ee50f0b32911dd48766137eee1dfc41">values</a>;
<a name="l00116"></a>00116     }
<a name="l00117"></a>00117 
<a name="l00121"></a><a class="code" href="classpopot_1_1Vector.html#a6d3cb96a58935fafa1020b7b5704effe">00121</a>     <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1Vector.html#a6d3cb96a58935fafa1020b7b5704effe">print</a>(std::ostream &amp; os)<span class="keyword"> const</span>
<a name="l00122"></a>00122 <span class="keyword">    </span>{
<a name="l00123"></a>00123       os &lt;&lt; <span class="stringliteral">&quot;[&quot;</span>;
<a name="l00124"></a>00124       <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1Vector.html#ad1802400de981925055e8ce885d41f01">size</a>() ; ++i)
<a name="l00125"></a>00125         {
<a name="l00126"></a>00126           os &lt;&lt; <a class="code" href="classpopot_1_1Vector.html#aefbef7f1d1b43f53aac6e2d717feb618">getValueAt</a>(i);
<a name="l00127"></a>00127           <span class="keywordflow">if</span>(i != <a class="code" href="classpopot_1_1Vector.html#ad1802400de981925055e8ce885d41f01">size</a>() - 1)
<a name="l00128"></a>00128             os &lt;&lt; <span class="stringliteral">&quot;;&quot;</span>;
<a name="l00129"></a>00129         }
<a name="l00130"></a>00130       os &lt;&lt; <span class="stringliteral">&quot;]&quot;</span>;
<a name="l00131"></a>00131     }
<a name="l00132"></a>00132 
<a name="l00137"></a><a class="code" href="classpopot_1_1Vector.html#ac254b27efeb8486ee2f67821e3a21a60">00137</a>     <span class="keyword">friend</span> std::ostream &amp; <a class="code" href="classpopot_1_1Vector.html#ac254b27efeb8486ee2f67821e3a21a60">operator &lt;&lt;</a>(std::ostream &amp; os, <span class="keyword">const</span> <a class="code" href="classpopot_1_1Vector.html" title="The template parameters are the type of values (e.g. double, or bool) and the dimension of the vector...">Vector</a> &amp;v)
<a name="l00138"></a>00138     {
<a name="l00139"></a>00139       v.print(os);
<a name="l00140"></a>00140       <span class="keywordflow">return</span> os;
<a name="l00141"></a>00141     }
<a name="l00142"></a>00142   };
<a name="l00143"></a>00143 
<a name="l00144"></a>00144 
<a name="l00145"></a>00145   <span class="keyword">namespace </span>PSO
<a name="l00146"></a>00146   {
<a name="l00147"></a><a class="code" href="namespacepopot_1_1PSO_1_1particle.html">00147</a>     <span class="keyword">namespace </span>particle
<a name="l00148"></a>00148     {
<a name="l00149"></a>00149 
<a name="l00153"></a>00153       <span class="keyword">template</span>&lt; <span class="keyword">typename</span> PROBLEM , <span class="keyword">typename</span> POSITION_INITIALIZER&gt;
<a name="l00154"></a>00154         <span class="keyword">class </span><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html">BaseParticle</a> : <span class="keyword">public</span> <a class="code" href="classpopot_1_1Vector.html" title="The template parameters are the type of values (e.g. double, or bool) and the dimension of the vector...">Vector</a>&lt;double, PROBLEM::nb_parameters&gt;
<a name="l00155"></a>00155         {
<a name="l00156"></a>00156         <span class="keyword">private</span>:
<a name="l00157"></a>00157           <span class="keyword">typedef</span> <a class="code" href="classpopot_1_1Vector.html">Vector&lt;double, PROBLEM::nb_parameters&gt;</a> TSuper;
<a name="l00158"></a>00158 
<a name="l00159"></a>00159         <span class="keyword">protected</span>:
<a name="l00160"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ac8daae6164db2cf271c553b81fb4547a">00160</a>           <span class="keywordtype">double</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ac8daae6164db2cf271c553b81fb4547a">_fitness</a>;
<a name="l00161"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ae290f9d61f6427d6f189e7473dfaff4d">00161</a>           <span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ae290f9d61f6427d6f189e7473dfaff4d">_dimension</a> = PROBLEM::nb_parameters;
<a name="l00162"></a>00162 
<a name="l00163"></a>00163         <span class="keyword">public</span>:  
<a name="l00164"></a>00164 
<a name="l00165"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a64b5ea8c391cfd1c52402e674f67a624">00165</a>           <span class="keyword">typedef</span> PROBLEM <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a64b5ea8c391cfd1c52402e674f67a624">Problem</a>;
<a name="l00166"></a>00166 
<a name="l00167"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ad5595292213af1ab81c47555ce2e593b">00167</a>         <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ad5595292213af1ab81c47555ce2e593b">BaseParticle</a>(<span class="keywordtype">void</span>) : <a class="code" href="classpopot_1_1Vector.html">TSuper</a>()
<a name="l00168"></a>00168             {
<a name="l00169"></a>00169             }
<a name="l00170"></a>00170           
<a name="l00171"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a665d2d4c1da6238757e11b2403e9c62e">00171</a>           <span class="keyword">virtual</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a665d2d4c1da6238757e11b2403e9c62e">~BaseParticle</a>(<span class="keywordtype">void</span>) 
<a name="l00172"></a>00172             {}
<a name="l00173"></a>00173 
<a name="l00174"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#aa225c8e740a1a95d381c5222112e7d82">00174</a>         <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ad5595292213af1ab81c47555ce2e593b">BaseParticle</a>( <span class="keyword">const</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html">BaseParticle</a> &amp; other) : <a class="code" href="classpopot_1_1Vector.html">TSuper</a>(other)
<a name="l00175"></a>00175             {
<a name="l00176"></a>00176               <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ac8daae6164db2cf271c553b81fb4547a">_fitness</a> = other.<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ac8daae6164db2cf271c553b81fb4547a">_fitness</a>;
<a name="l00177"></a>00177             }
<a name="l00178"></a>00178 
<a name="l00179"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#aaaf0492174a7e19ffa5b2e1767e594af">00179</a>           <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html">BaseParticle</a> &amp; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#aaaf0492174a7e19ffa5b2e1767e594af">operator=</a>(<span class="keyword">const</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html">BaseParticle</a> &amp;other)
<a name="l00180"></a>00180             {
<a name="l00181"></a>00181               this-&gt;<a class="code" href="classpopot_1_1Vector.html#a512e762c4f86b77533513bd7b429a27f">TSuper::operator=</a>(other);
<a name="l00182"></a>00182               <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ac8daae6164db2cf271c553b81fb4547a">_fitness</a> = other.<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ac8daae6164db2cf271c553b81fb4547a">_fitness</a>;
<a name="l00183"></a>00183               <span class="keywordflow">return</span> *<span class="keyword">this</span>;
<a name="l00184"></a>00184             }
<a name="l00185"></a>00185 
<a name="l00189"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a18d3b5bcd0e9b6b784d6154026b9ab92">00189</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a18d3b5bcd0e9b6b784d6154026b9ab92">init</a>(<span class="keywordtype">void</span>)
<a name="l00190"></a>00190           {
<a name="l00191"></a>00191             <span class="comment">// Initialize the position</span>
<a name="l00192"></a>00192             <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a9db27703ee0b5fa4bf6b3557e231bbd6">initPosition</a>();
<a name="l00193"></a>00193 
<a name="l00194"></a>00194             <span class="comment">// Evaluate the fitness</span>
<a name="l00195"></a>00195             <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a29e1b4dcccf15a6e74b5ac6c842bd825">evaluateFitness</a>();
<a name="l00196"></a>00196           }
<a name="l00197"></a>00197 
<a name="l00201"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a9db27703ee0b5fa4bf6b3557e231bbd6">00201</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a9db27703ee0b5fa4bf6b3557e231bbd6">initPosition</a>()
<a name="l00202"></a>00202           {
<a name="l00203"></a>00203             <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a18d3b5bcd0e9b6b784d6154026b9ab92">POSITION_INITIALIZER::init</a>(PROBLEM::get_lbound, 
<a name="l00204"></a>00204                                        PROBLEM::get_ubound,
<a name="l00205"></a>00205                                        <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ae290f9d61f6427d6f189e7473dfaff4d">_dimension</a>,
<a name="l00206"></a>00206                                        this-&gt;<a class="code" href="classpopot_1_1Vector.html#aa74fc0320c51efea093baeafb62a9c21">getValuesPtr</a>());
<a name="l00207"></a>00207           }
<a name="l00208"></a>00208 
<a name="l00212"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a7612290063de657dafec99cb35ee4032">00212</a>           <span class="keywordtype">double</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a7612290063de657dafec99cb35ee4032">getPosition</a>(<span class="keywordtype">int</span> i)<span class="keyword"> const</span>
<a name="l00213"></a>00213 <span class="keyword">          </span>{
<a name="l00214"></a>00214             <span class="keywordflow">return</span> this-&gt;<a class="code" href="classpopot_1_1Vector.html#aefbef7f1d1b43f53aac6e2d717feb618">getValueAt</a>(i);
<a name="l00215"></a>00215           }
<a name="l00219"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a0581e894ca7df2ef6451c7e10a11d8b6">00219</a>           <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a0581e894ca7df2ef6451c7e10a11d8b6">setPosition</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">double</span> val)
<a name="l00220"></a>00220           {
<a name="l00221"></a>00221             this-&gt;<a class="code" href="classpopot_1_1Vector.html#a1df5ea1f345af90326a85e566b25d0e5">setValueAt</a>(i, val);
<a name="l00222"></a>00222           }
<a name="l00223"></a>00223 
<a name="l00227"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#aee55b1d6301364f08df9abfc8d364a52">00227</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#aee55b1d6301364f08df9abfc8d364a52">confine</a>(<span class="keywordtype">void</span>)
<a name="l00228"></a>00228           {
<a name="l00229"></a>00229             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ae290f9d61f6427d6f189e7473dfaff4d">_dimension</a> ; ++i)
<a name="l00230"></a>00230               {
<a name="l00231"></a>00231                 <span class="keywordflow">if</span>(<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a7612290063de657dafec99cb35ee4032">getPosition</a>(i) &lt; PROBLEM::get_lbound(i))
<a name="l00232"></a>00232                   <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a0581e894ca7df2ef6451c7e10a11d8b6">setPosition</a>(i, PROBLEM::get_lbound(i));
<a name="l00233"></a>00233                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a7612290063de657dafec99cb35ee4032">getPosition</a>(i) &gt; PROBLEM::get_ubound(i))
<a name="l00234"></a>00234                   <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a0581e894ca7df2ef6451c7e10a11d8b6">setPosition</a>(i, PROBLEM::get_ubound(i));
<a name="l00235"></a>00235               }
<a name="l00236"></a>00236           }
<a name="l00237"></a>00237 
<a name="l00241"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ac85ece6d8119d4867e1c8cb15d6ce2ba">00241</a>           <span class="keywordtype">double</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ac85ece6d8119d4867e1c8cb15d6ce2ba">getFitness</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00242"></a>00242 <span class="keyword">          </span>{
<a name="l00243"></a>00243             <span class="keywordflow">return</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ac8daae6164db2cf271c553b81fb4547a">_fitness</a>;
<a name="l00244"></a>00244           }
<a name="l00245"></a>00245 
<a name="l00249"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ab2d4c6fddb263fd02192e438bd0d64fa">00249</a>           <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ab2d4c6fddb263fd02192e438bd0d64fa">setFitness</a>(<span class="keywordtype">double</span> f)
<a name="l00250"></a>00250           {
<a name="l00251"></a>00251             <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ac8daae6164db2cf271c553b81fb4547a">_fitness</a> = f;
<a name="l00252"></a>00252           }
<a name="l00253"></a>00253         
<a name="l00257"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a29e1b4dcccf15a6e74b5ac6c842bd825">00257</a>           <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a29e1b4dcccf15a6e74b5ac6c842bd825">evaluateFitness</a>(<span class="keywordtype">void</span>)
<a name="l00258"></a>00258           {
<a name="l00259"></a>00259             <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ac8daae6164db2cf271c553b81fb4547a">_fitness</a> = PROBLEM::evaluate(this-&gt;<a class="code" href="classpopot_1_1Vector.html#aa74fc0320c51efea093baeafb62a9c21">getValuesPtr</a>());
<a name="l00260"></a>00260             <span class="keywordflow">return</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ac8daae6164db2cf271c553b81fb4547a">_fitness</a>;
<a name="l00261"></a>00261           }
<a name="l00265"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a284051968664d2bcdc306233a1dc7577">00265</a>           <span class="keywordtype">bool</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a284051968664d2bcdc306233a1dc7577">operator&lt;</a>(<span class="keyword">const</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html">BaseParticle</a> &amp;p)<span class="keyword"> const</span>
<a name="l00266"></a>00266 <span class="keyword">          </span>{
<a name="l00267"></a>00267             <span class="keywordflow">return</span> (<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#aa8e1ed2b75642690eb15c476be040366">compare</a>(p) &lt; 0);
<a name="l00268"></a>00268           }
<a name="l00275"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#aa8e1ed2b75642690eb15c476be040366">00275</a>           <span class="keyword">virtual</span> <span class="keywordtype">int</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#aa8e1ed2b75642690eb15c476be040366">compare</a>(<span class="keyword">const</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html">BaseParticle</a>&amp; p)<span class="keyword"> const</span>
<a name="l00276"></a>00276 <span class="keyword">          </span>{
<a name="l00277"></a>00277             <span class="keywordtype">double</span> myfitness = <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ac85ece6d8119d4867e1c8cb15d6ce2ba">getFitness</a>();
<a name="l00278"></a>00278             <span class="keywordtype">double</span> otherfitness = p.<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ac85ece6d8119d4867e1c8cb15d6ce2ba">getFitness</a>();
<a name="l00279"></a>00279             <span class="keywordflow">if</span>(myfitness &lt; otherfitness)
<a name="l00280"></a>00280               <span class="keywordflow">return</span> -1;
<a name="l00281"></a>00281             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(myfitness &gt; otherfitness)
<a name="l00282"></a>00282               <span class="keywordflow">return</span> 1;
<a name="l00283"></a>00283             <span class="keywordflow">else</span>
<a name="l00284"></a>00284               <span class="keywordflow">return</span> 0;
<a name="l00285"></a>00285           }  
<a name="l00286"></a>00286 
<a name="l00287"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#af1292d8ea56105dacf3b5ba6f6b384a0">00287</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#af1292d8ea56105dacf3b5ba6f6b384a0">print</a>(std::ostream &amp; os)<span class="keyword"> const</span>
<a name="l00288"></a>00288 <span class="keyword">          </span>{
<a name="l00289"></a>00289             <a class="code" href="classpopot_1_1Vector.html#a6d3cb96a58935fafa1020b7b5704effe">TSuper::print</a>(os);
<a name="l00290"></a>00290             os &lt;&lt; <span class="stringliteral">&quot; ; Fitness : &quot;</span> &lt;&lt; this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ac85ece6d8119d4867e1c8cb15d6ce2ba">getFitness</a>();
<a name="l00291"></a>00291           }
<a name="l00292"></a>00292         
<a name="l00293"></a>00293         };
<a name="l00294"></a>00294 
<a name="l00295"></a>00295 
<a name="l00296"></a>00296       <span class="comment">// Particle introduces the notion</span>
<a name="l00297"></a>00297       <span class="comment">// of neighborhood and velocity</span>
<a name="l00298"></a>00298       <span class="comment">// and best position</span>
<a name="l00299"></a>00299       <span class="keyword">template</span>&lt; <span class="keyword">typename</span> PROBLEM, <span class="keyword">typename</span> POSITION_INITIALIZER, <span class="keyword">typename</span> VELOCITY_INITIALIZER&gt;
<a name="l00300"></a>00300         <span class="keyword">class </span>Particle : <span class="keyword">public</span> BaseParticle&lt;PROBLEM, POSITION_INITIALIZER&gt;
<a name="l00301"></a>00301         {
<a name="l00302"></a>00302         <span class="keyword">private</span>:
<a name="l00303"></a>00303           <span class="keyword">typedef</span> BaseParticle&lt;PROBLEM, POSITION_INITIALIZER&gt; TSuper;
<a name="l00304"></a>00304           <span class="keyword">typedef</span> Particle&lt;PROBLEM, POSITION_INITIALIZER,VELOCITY_INITIALIZER &gt; ThisParticleType;
<a name="l00305"></a>00305 
<a name="l00306"></a>00306         <span class="keyword">public</span>:
<a name="l00307"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a2cc055cf82a34c517a513af41deb62b8">00307</a>           <span class="keyword">typedef</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html">BaseParticle&lt;PROBLEM, POSITION_INITIALIZER&gt;</a> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a2cc055cf82a34c517a513af41deb62b8">BestType</a>;
<a name="l00308"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#aa44ea6ac3cd2e1396f73aaf30c93b513">00308</a>           <span class="keyword">typedef</span> popot<a class="code" href="classpopot_1_1PSO_1_1neighborhood_1_1Neighborhood.html" title="A neighborhood contains a vector of particles belonging to the neighborhood as well as a pointer (not...">::PSO::neighborhood::Neighborhood&lt; ThisParticleType &gt;</a> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#aa44ea6ac3cd2e1396f73aaf30c93b513">NeighborhoodType</a>;
<a name="l00309"></a>00309         
<a name="l00310"></a>00310         
<a name="l00311"></a>00311         <span class="keyword">protected</span>:
<a name="l00312"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a05391d18e4af7c73368874b019831d34">00312</a>           <span class="keywordtype">double</span> *<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a05391d18e4af7c73368874b019831d34">_velocity</a>;
<a name="l00313"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a7f1a0546236dac2736a185efb0d05ea4">00313</a>           <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html">BestType</a> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a7f1a0546236dac2736a185efb0d05ea4">_best_position</a>;
<a name="l00314"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a25187bd4ccc40341dc3a038f9cc11a47">00314</a>           <a class="code" href="classpopot_1_1PSO_1_1neighborhood_1_1Neighborhood.html" title="A neighborhood contains a vector of particles belonging to the neighborhood as well as a pointer (not...">NeighborhoodType</a> *<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a25187bd4ccc40341dc3a038f9cc11a47">_neighborhood</a>;
<a name="l00315"></a>00315         
<a name="l00316"></a>00316         <span class="keyword">public</span>:
<a name="l00317"></a>00317 
<a name="l00318"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a523916d62d75bc1f245c593c696a0c52">00318</a>         <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a523916d62d75bc1f245c593c696a0c52">Particle</a>(<span class="keywordtype">void</span>) : <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html">TSuper</a>()
<a name="l00319"></a>00319             {
<a name="l00320"></a>00320               <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a05391d18e4af7c73368874b019831d34">_velocity</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html">TSuper</a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ae290f9d61f6427d6f189e7473dfaff4d">::_dimension</a>];
<a name="l00321"></a>00321               memset(<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a05391d18e4af7c73368874b019831d34">_velocity</a>, 0, <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ae290f9d61f6427d6f189e7473dfaff4d">TSuper::_dimension</a> * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));
<a name="l00322"></a>00322 
<a name="l00323"></a>00323               <span class="comment">// Create an empty neighborhood</span>
<a name="l00324"></a>00324               <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a25187bd4ccc40341dc3a038f9cc11a47">_neighborhood</a> = <span class="keyword">new</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#aa44ea6ac3cd2e1396f73aaf30c93b513">NeighborhoodType</a>();
<a name="l00325"></a>00325             }
<a name="l00326"></a>00326 
<a name="l00327"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a63a8672d03c2cc3cd79faf36835c94fc">00327</a>         <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a523916d62d75bc1f245c593c696a0c52">Particle</a>(<span class="keyword">const</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">Particle</a>&amp; other) : <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html">TSuper</a>(other), <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a7f1a0546236dac2736a185efb0d05ea4">_best_position</a>(other.<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a1aaae385ccca7c02f4ed88b510063c27">getBestPosition</a>())
<a name="l00328"></a>00328             {
<a name="l00329"></a>00329               <span class="comment">// Copy the velocity</span>
<a name="l00330"></a>00330               <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a05391d18e4af7c73368874b019831d34">_velocity</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html">TSuper</a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ae290f9d61f6427d6f189e7473dfaff4d">::_dimension</a>];
<a name="l00331"></a>00331               <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html">TSuper</a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ae290f9d61f6427d6f189e7473dfaff4d">::_dimension</a> ; ++i)
<a name="l00332"></a>00332                 <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a05391d18e4af7c73368874b019831d34">_velocity</a>[i] = other.getVelocity(i);
<a name="l00333"></a>00333 
<a name="l00334"></a>00334               <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a25187bd4ccc40341dc3a038f9cc11a47">_neighborhood</a> = <span class="keyword">new</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#aa44ea6ac3cd2e1396f73aaf30c93b513">NeighborhoodType</a>(*(other.getNeighborhood()));
<a name="l00335"></a>00335               <span class="comment">//_neighborhood = new NeighborhoodType();</span>
<a name="l00336"></a>00336               <span class="comment">//for(int i = 0 ; i &lt; other.getNeighborhood()-&gt;size() ; ++i)</span>
<a name="l00337"></a>00337               <span class="comment">// _neighborhood-&gt;add(other.getNeighborhood()-&gt;get(i));</span>
<a name="l00338"></a>00338             }
<a name="l00339"></a>00339 
<a name="l00340"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a5a321e90d6b72ae4a50f8d658a5f9eb8">00340</a>           <span class="keyword">virtual</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a5a321e90d6b72ae4a50f8d658a5f9eb8">~Particle</a>(<span class="keywordtype">void</span>)
<a name="l00341"></a>00341             {
<a name="l00342"></a>00342               <span class="keyword">delete</span>[] <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a05391d18e4af7c73368874b019831d34">_velocity</a>;
<a name="l00343"></a>00343               <span class="keyword">delete</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a25187bd4ccc40341dc3a038f9cc11a47">_neighborhood</a>;
<a name="l00344"></a>00344             }
<a name="l00345"></a>00345 
<a name="l00349"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a22becdaacc72b9f5b129123030de46e8">00349</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a22becdaacc72b9f5b129123030de46e8">init</a>(<span class="keywordtype">void</span>)
<a name="l00350"></a>00350           {
<a name="l00351"></a>00351             <span class="comment">// Initialize the position</span>
<a name="l00352"></a>00352             <span class="comment">// and computes the fitness</span>
<a name="l00353"></a>00353             <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a18d3b5bcd0e9b6b784d6154026b9ab92">TSuper::init</a>();
<a name="l00354"></a>00354 
<a name="l00355"></a>00355             <span class="comment">// Initialize the velocity</span>
<a name="l00356"></a>00356             <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a9f6b1824bd9a157cc86d67c657414f53">initVelocity</a>();
<a name="l00357"></a>00357 
<a name="l00358"></a>00358             <span class="comment">// Set the best particle to the current position</span>
<a name="l00359"></a>00359             <span class="comment">// Just copies the position and fitness</span>
<a name="l00360"></a>00360             <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a7f1a0546236dac2736a185efb0d05ea4">_best_position</a> = *<span class="keyword">this</span>;
<a name="l00361"></a>00361           }
<a name="l00362"></a>00362 
<a name="l00363"></a>00363 
<a name="l00367"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a9f6b1824bd9a157cc86d67c657414f53">00367</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a9f6b1824bd9a157cc86d67c657414f53">initVelocity</a>(<span class="keywordtype">void</span>)
<a name="l00368"></a>00368           {
<a name="l00369"></a>00369             <span class="keywordtype">double</span> params[3];
<a name="l00370"></a>00370             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html">TSuper</a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ae290f9d61f6427d6f189e7473dfaff4d">::_dimension</a> ; ++i)
<a name="l00371"></a>00371               {
<a name="l00372"></a>00372                 params[0] = PROBLEM::get_lbound(i);
<a name="l00373"></a>00373                 params[1] = PROBLEM::get_ubound(i);
<a name="l00374"></a>00374                 params[2] = this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a7612290063de657dafec99cb35ee4032">getPosition</a>(i);
<a name="l00375"></a>00375                 <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#af5af1fff27bfe5156633acb8e0f8acdf">setVelocity</a>(i, VELOCITY_INITIALIZER::init(params));
<a name="l00376"></a>00376               }
<a name="l00377"></a>00377           }
<a name="l00378"></a>00378 
<a name="l00382"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#afae4802e0e1ebe2e9396671f48513d10">00382</a>           <span class="keywordtype">double</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#afae4802e0e1ebe2e9396671f48513d10">getVelocity</a>(<span class="keywordtype">int</span> i)<span class="keyword"> const</span>
<a name="l00383"></a>00383 <span class="keyword">          </span>{
<a name="l00384"></a>00384             <span class="keywordflow">if</span>(i &gt;= 0 &amp;&amp; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ae290f9d61f6427d6f189e7473dfaff4d">TSuper::_dimension</a>)
<a name="l00385"></a>00385               <span class="keywordflow">return</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a05391d18e4af7c73368874b019831d34">_velocity</a>[i];
<a name="l00386"></a>00386             <span class="keywordflow">else</span>
<a name="l00387"></a>00387               <span class="keywordflow">throw</span> <a class="code" href="classpopot_1_1Exception_1_1IndexOutOfRange.html">popot::Exception::IndexOutOfRange</a>(i, <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ae290f9d61f6427d6f189e7473dfaff4d">TSuper::_dimension</a>);
<a name="l00388"></a>00388           }
<a name="l00389"></a>00389 
<a name="l00393"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#af5af1fff27bfe5156633acb8e0f8acdf">00393</a>           <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#af5af1fff27bfe5156633acb8e0f8acdf">setVelocity</a>(<span class="keywordtype">int</span> i, <span class="keywordtype">double</span> value)
<a name="l00394"></a>00394           {
<a name="l00395"></a>00395             <span class="keywordflow">if</span>(i &gt;= 0 &amp;&amp; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ae290f9d61f6427d6f189e7473dfaff4d">TSuper::_dimension</a>)
<a name="l00396"></a>00396               <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a05391d18e4af7c73368874b019831d34">_velocity</a>[i] = value;
<a name="l00397"></a>00397             <span class="keywordflow">else</span>
<a name="l00398"></a>00398               <span class="keywordflow">throw</span> <a class="code" href="classpopot_1_1Exception_1_1IndexOutOfRange.html">popot::Exception::IndexOutOfRange</a>(i, <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ae290f9d61f6427d6f189e7473dfaff4d">TSuper::_dimension</a>);
<a name="l00399"></a>00399           }
<a name="l00400"></a>00400 
<a name="l00406"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#aed0976964a6959636f1e6cd85445843d">00406</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#aed0976964a6959636f1e6cd85445843d">confine</a>(<span class="keywordtype">void</span>)
<a name="l00407"></a>00407           {
<a name="l00408"></a>00408             <span class="comment">// In case the position is out of the bounds</span>
<a name="l00409"></a>00409             <span class="comment">// we reset the velocities</span>
<a name="l00410"></a>00410             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html">TSuper</a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ae290f9d61f6427d6f189e7473dfaff4d">::_dimension</a> ; ++i)
<a name="l00411"></a>00411               {
<a name="l00412"></a>00412                 <span class="keywordflow">if</span>((this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a7612290063de657dafec99cb35ee4032">getPosition</a>(i) &lt; PROBLEM::get_lbound(i)))
<a name="l00413"></a>00413                   {
<a name="l00414"></a>00414                     this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a0581e894ca7df2ef6451c7e10a11d8b6">setPosition</a>(i, PROBLEM::get_lbound(i));
<a name="l00415"></a>00415                     this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#af5af1fff27bfe5156633acb8e0f8acdf">setVelocity</a>(i,0);
<a name="l00416"></a>00416                   }
<a name="l00417"></a>00417                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a7612290063de657dafec99cb35ee4032">getPosition</a>(i) &gt; PROBLEM::get_ubound(i))
<a name="l00418"></a>00418                   {               
<a name="l00419"></a>00419                     this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a0581e894ca7df2ef6451c7e10a11d8b6">setPosition</a>(i, PROBLEM::get_ubound(i));
<a name="l00420"></a>00420                     this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#af5af1fff27bfe5156633acb8e0f8acdf">setVelocity</a>(i,0);
<a name="l00421"></a>00421                   }
<a name="l00422"></a>00422               }
<a name="l00423"></a>00423           }
<a name="l00424"></a>00424 
<a name="l00428"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a9dff6de03b2bb2eca4419929d2608513">00428</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a9dff6de03b2bb2eca4419929d2608513">updateBestPosition</a>(<span class="keywordtype">void</span>)
<a name="l00429"></a>00429           {
<a name="l00430"></a>00430             <span class="keywordflow">if</span>(<a class="code" href="popot_8h.html#ab33dc5d314404556a2693e57728abd85">VERBOSE_BENCH</a>)
<a name="l00431"></a>00431               {
<a name="l00432"></a>00432                 std::cout &lt;&lt; <span class="stringliteral">&quot;Previous best : &quot;</span> &lt;&lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a7f1a0546236dac2736a185efb0d05ea4">_best_position</a>.<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ac85ece6d8119d4867e1c8cb15d6ce2ba">getFitness</a>() &lt;&lt; <span class="stringliteral">&quot; : &quot;</span>;
<a name="l00433"></a>00433                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html">TSuper</a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ae290f9d61f6427d6f189e7473dfaff4d">::_dimension</a> ; ++i)
<a name="l00434"></a>00434                   std::cout &lt;&lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a7f1a0546236dac2736a185efb0d05ea4">_best_position</a>.<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a7612290063de657dafec99cb35ee4032">getPosition</a>(i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00435"></a>00435                 std::cout &lt;&lt; std::endl;
<a name="l00436"></a>00436               }
<a name="l00437"></a>00437             <span class="comment">// Update the best position the particle ever had</span>
<a name="l00438"></a>00438             <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#aa8e1ed2b75642690eb15c476be040366">compare</a>(<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a7f1a0546236dac2736a185efb0d05ea4">_best_position</a>) &lt; 0)
<a name="l00439"></a>00439               <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a7f1a0546236dac2736a185efb0d05ea4">_best_position</a> = *<span class="keyword">this</span>;
<a name="l00440"></a>00440             
<a name="l00441"></a>00441             <span class="keywordflow">if</span>(<a class="code" href="popot_8h.html#ab33dc5d314404556a2693e57728abd85">VERBOSE_BENCH</a>)
<a name="l00442"></a>00442               {
<a name="l00443"></a>00443                 std::cout &lt;&lt; <span class="stringliteral">&quot;New best : &quot;</span> &lt;&lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a7f1a0546236dac2736a185efb0d05ea4">_best_position</a>.<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ac85ece6d8119d4867e1c8cb15d6ce2ba">getFitness</a>() &lt;&lt; <span class="stringliteral">&quot; : &quot;</span>;
<a name="l00444"></a>00444                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html">TSuper</a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ae290f9d61f6427d6f189e7473dfaff4d">::_dimension</a> ; ++i)
<a name="l00445"></a>00445                   std::cout &lt;&lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a7f1a0546236dac2736a185efb0d05ea4">_best_position</a>.<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a7612290063de657dafec99cb35ee4032">getPosition</a>(i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00446"></a>00446                 std::cout &lt;&lt; std::endl;
<a name="l00447"></a>00447               }
<a name="l00448"></a>00448           }
<a name="l00449"></a>00449 
<a name="l00453"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a160d0b282d9a84cd7b26477479022a90">00453</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a160d0b282d9a84cd7b26477479022a90">updatePosition</a>(<span class="keywordtype">void</span>)
<a name="l00454"></a>00454           {
<a name="l00455"></a>00455             std::cout &lt;&lt; <span class="stringliteral">&quot;No updatePosition rule is provided for a particle of type Particle &quot;</span> &lt;&lt; std::endl;
<a name="l00456"></a>00456           }
<a name="l00457"></a>00457 
<a name="l00461"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a4c5a6eabd33916b4bd9780d2d3f89ba1">00461</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a4c5a6eabd33916b4bd9780d2d3f89ba1">updateVelocity</a>(<span class="keywordtype">void</span>)
<a name="l00462"></a>00462           {
<a name="l00463"></a>00463             std::cout &lt;&lt; <span class="stringliteral">&quot;No updateVelocity rule is provided for a particle of type Particle &quot;</span> &lt;&lt; std::endl;
<a name="l00464"></a>00464           }
<a name="l00465"></a>00465 
<a name="l00466"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a1aaae385ccca7c02f4ed88b510063c27">00466</a>           <span class="keyword">virtual</span> <span class="keyword">const</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html">BestType</a> &amp; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a1aaae385ccca7c02f4ed88b510063c27">getBestPosition</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00467"></a>00467 <span class="keyword">          </span>{
<a name="l00468"></a>00468             <span class="keywordflow">return</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a7f1a0546236dac2736a185efb0d05ea4">_best_position</a>;
<a name="l00469"></a>00469           }
<a name="l00470"></a>00470 
<a name="l00474"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#ae67a14bbe108cf5e6d1d45ce23923b91">00474</a>           <a class="code" href="classpopot_1_1PSO_1_1neighborhood_1_1Neighborhood.html" title="A neighborhood contains a vector of particles belonging to the neighborhood as well as a pointer (not...">NeighborhoodType</a>* <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#ae67a14bbe108cf5e6d1d45ce23923b91">getNeighborhood</a>(<span class="keywordtype">void</span>)<span class="keyword"> const</span>
<a name="l00475"></a>00475 <span class="keyword">          </span>{
<a name="l00476"></a>00476             <span class="keywordflow">return</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a25187bd4ccc40341dc3a038f9cc11a47">_neighborhood</a>;
<a name="l00477"></a>00477           }
<a name="l00478"></a>00478 
<a name="l00482"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a6d820878afe789c21f56e79365ba038f">00482</a>           <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a6d820878afe789c21f56e79365ba038f">setNeighborhood</a>(<a class="code" href="classpopot_1_1PSO_1_1neighborhood_1_1Neighborhood.html" title="A neighborhood contains a vector of particles belonging to the neighborhood as well as a pointer (not...">NeighborhoodType</a> * neighborhood)
<a name="l00483"></a>00483           {
<a name="l00484"></a>00484             <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a25187bd4ccc40341dc3a038f9cc11a47">_neighborhood</a> = neighborhood;
<a name="l00485"></a>00485           }
<a name="l00486"></a>00486 
<a name="l00487"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a6f02b4e144a100a4e3889a7c6aa1fdfb">00487</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a6f02b4e144a100a4e3889a7c6aa1fdfb">print</a>(std::ostream &amp; os)<span class="keyword"> const</span>
<a name="l00488"></a>00488 <span class="keyword">          </span>{
<a name="l00489"></a>00489             <span class="comment">/*</span>
<a name="l00490"></a>00490 <span class="comment">            printf(&quot;%f - &quot;, this-&gt;getFitness());</span>
<a name="l00491"></a>00491 <span class="comment">            for(int i = 0 ; i &lt; TSuper::_dimension ; ++i)</span>
<a name="l00492"></a>00492 <span class="comment">              {</span>
<a name="l00493"></a>00493 <span class="comment">                printf(&quot;(%f,%f,%f) &quot;, this-&gt;getPosition(i),this-&gt;getVelocity(i),_best_position.getPosition(i));</span>
<a name="l00494"></a>00494 <span class="comment">              }</span>
<a name="l00495"></a>00495 <span class="comment">            printf(&quot;\n&quot;);</span>
<a name="l00496"></a>00496 <span class="comment">            */</span>
<a name="l00497"></a>00497             <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#af1292d8ea56105dacf3b5ba6f6b384a0">TSuper::print</a>(os);
<a name="l00498"></a>00498             os &lt;&lt; <span class="stringliteral">&quot;; Best position : &quot;</span> &lt;&lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a7f1a0546236dac2736a185efb0d05ea4">_best_position</a>;
<a name="l00499"></a>00499           }
<a name="l00500"></a>00500 
<a name="l00501"></a>00501         };
<a name="l00502"></a>00502 
<a name="l00508"></a>00508       <span class="keyword">template</span>&lt; <span class="keyword">typename</span> PROBLEM, <span class="keyword">typename</span> PARTICLE_PARAMS, <span class="keyword">typename</span> POSITION_INITIALIZER=popot::PSO::initializer::PositionUniformRandom, <span class="keyword">typename</span> VELOCITY_INITIALIZER=popot::PSO::initializer::VelocityHalfDiff&gt;
<a name="l00509"></a>00509         <span class="keyword">class </span>SPSO2006Particle : <span class="keyword">public</span> Particle&lt;PROBLEM, POSITION_INITIALIZER, VELOCITY_INITIALIZER &gt;
<a name="l00510"></a>00510         {
<a name="l00511"></a>00511           <span class="keyword">typedef</span> Particle&lt;PROBLEM, POSITION_INITIALIZER, VELOCITY_INITIALIZER &gt; TSuper;
<a name="l00512"></a>00512 
<a name="l00513"></a>00513         <span class="keyword">public</span>:
<a name="l00514"></a>00514 
<a name="l00515"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2006Particle.html#a62f1348050080013f4bc629ee4940ddc">00515</a>         <a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2006Particle.html#a62f1348050080013f4bc629ee4940ddc">SPSO2006Particle</a>(<span class="keywordtype">void</span>) : <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>()
<a name="l00516"></a>00516             {
<a name="l00517"></a>00517             }
<a name="l00518"></a>00518 
<a name="l00522"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2006Particle.html#a1b804715cd7f2697f1e03775c8951ec8">00522</a>           <span class="keyword">virtual</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2006Particle.html#a1b804715cd7f2697f1e03775c8951ec8">~SPSO2006Particle</a>(<span class="keywordtype">void</span>)
<a name="l00523"></a>00523             {
<a name="l00524"></a>00524             }
<a name="l00525"></a>00525 
<a name="l00529"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2006Particle.html#a0e0db6442abdcbb751ccc2158399b273">00529</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2006Particle.html#a0e0db6442abdcbb751ccc2158399b273">updatePosition</a>(<span class="keywordtype">void</span>)
<a name="l00530"></a>00530           {
<a name="l00531"></a>00531             <span class="comment">// Here it is simply : p_{k+1} = p_k + v_k</span>
<a name="l00532"></a>00532             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00533"></a>00533               this-&gt;setPosition(i, this-&gt;getPosition(i) + this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#afae4802e0e1ebe2e9396671f48513d10">getVelocity</a>(i));
<a name="l00534"></a>00534           }
<a name="l00535"></a>00535 
<a name="l00539"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2006Particle.html#a588cd5f69c95d53c930199f946af1660">00539</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2006Particle.html#a588cd5f69c95d53c930199f946af1660">updateVelocity</a>(<span class="keywordtype">void</span>)
<a name="l00540"></a>00540           {
<a name="l00541"></a>00541             <span class="comment">// The update of the velocity is done according to the equation :</span>
<a name="l00542"></a>00542             <span class="comment">// v = w * v + c r1 (best_p - p) + c r2 (best_g - p)</span>
<a name="l00543"></a>00543             <span class="comment">// with :</span>
<a name="l00544"></a>00544             <span class="comment">// r_p, r_g two random real numbers in [0.0,1.0]</span>
<a name="l00545"></a>00545             <span class="comment">// w, c1, c2 : user defined parameters</span>
<a name="l00546"></a>00546             <span class="comment">// best_p : the best position the particle ever had</span>
<a name="l00547"></a>00547             <span class="comment">// best_g : the best position the neighborhood ever had</span>
<a name="l00548"></a>00548             <span class="keywordtype">double</span> r1,r2;
<a name="l00549"></a>00549             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00550"></a>00550               {
<a name="l00551"></a>00551                 r1 = <a class="code" href="namespacepopot_1_1math.html#aff66c3835eec2f4653b273e25e8c841b">popot::math::uniform_random</a>(0.0,PARTICLE_PARAMS::c());
<a name="l00552"></a>00552                 r2 = <a class="code" href="namespacepopot_1_1math.html#aff66c3835eec2f4653b273e25e8c841b">popot::math::uniform_random</a>(0.0,PARTICLE_PARAMS::c());
<a name="l00553"></a>00553                 this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#af5af1fff27bfe5156633acb8e0f8acdf">setVelocity</a>(i, PARTICLE_PARAMS::w() * this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#afae4802e0e1ebe2e9396671f48513d10">getVelocity</a>(i)
<a name="l00554"></a>00554                                   + r1 * (this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a1aaae385ccca7c02f4ed88b510063c27">getBestPosition</a>().getPosition(i) - this-&gt;getPosition(i))
<a name="l00555"></a>00555                                   + r2 * (this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#ae67a14bbe108cf5e6d1d45ce23923b91">getNeighborhood</a>()-&gt;getBest()-&gt;getPosition(i) - this-&gt;getPosition(i)));
<a name="l00556"></a>00556               }
<a name="l00557"></a>00557           }
<a name="l00558"></a>00558         };
<a name="l00559"></a>00559 
<a name="l00564"></a>00564       <span class="keyword">template</span>&lt; <span class="keyword">typename</span> PROBLEM, <span class="keyword">typename</span> PARTICLE_PARAMS, <span class="keyword">typename</span> POSITION_INITIALIZER=popot::PSO::initializer::PositionUniformRandom, <span class="keyword">typename</span> VELOCITY_INITIALIZER=popot::PSO::initializer::VelocityHalfDiff &gt;
<a name="l00565"></a>00565         <span class="keyword">class </span>SPSO2007Particle : <span class="keyword">public</span> Particle&lt;PROBLEM, POSITION_INITIALIZER, VELOCITY_INITIALIZER &gt;
<a name="l00566"></a>00566         {
<a name="l00567"></a>00567           <span class="keyword">typedef</span> Particle&lt;PROBLEM, POSITION_INITIALIZER, VELOCITY_INITIALIZER&gt; TSuper;
<a name="l00568"></a>00568 
<a name="l00569"></a>00569         <span class="keyword">public</span>:
<a name="l00570"></a>00570 
<a name="l00571"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2007Particle.html#a58720492bc2651d39d3da3645df5a2f0">00571</a>         <a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2007Particle.html#a58720492bc2651d39d3da3645df5a2f0">SPSO2007Particle</a>(<span class="keywordtype">void</span>) : <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>()
<a name="l00572"></a>00572             {
<a name="l00573"></a>00573             }
<a name="l00574"></a>00574 
<a name="l00578"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2007Particle.html#a324b6ed285f2092713f284fe766c75de">00578</a>           <span class="keyword">virtual</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2007Particle.html#a324b6ed285f2092713f284fe766c75de">~SPSO2007Particle</a>(<span class="keywordtype">void</span>)
<a name="l00579"></a>00579             {
<a name="l00580"></a>00580             }
<a name="l00581"></a>00581 
<a name="l00585"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2007Particle.html#a79b8729d37918adb391706a180dffebc">00585</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2007Particle.html#a79b8729d37918adb391706a180dffebc">updatePosition</a>(<span class="keywordtype">void</span>)
<a name="l00586"></a>00586           {
<a name="l00587"></a>00587             <span class="comment">// Here it is simply : p_{k+1} = p_k + v_k</span>
<a name="l00588"></a>00588             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00589"></a>00589               this-&gt;setPosition(i, this-&gt;getPosition(i) + this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#afae4802e0e1ebe2e9396671f48513d10">getVelocity</a>(i));
<a name="l00590"></a>00590           }
<a name="l00591"></a>00591 
<a name="l00595"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2007Particle.html#aad46fedf6961ae00f31155c8c42cb485">00595</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2007Particle.html#aad46fedf6961ae00f31155c8c42cb485">updateVelocity</a>(<span class="keywordtype">void</span>)
<a name="l00596"></a>00596           {
<a name="l00597"></a>00597             <span class="comment">// The update of the velocity is done according to the equation :</span>
<a name="l00598"></a>00598             <span class="comment">// v = w * v + r1 (best_p - p) + r2 (best_g - p)</span>
<a name="l00599"></a>00599             <span class="comment">// with :</span>
<a name="l00600"></a>00600             <span class="comment">// r_1, r_2 two random real numbers in [0.0,c]</span>
<a name="l00601"></a>00601             <span class="comment">// w, c : user defined parameters</span>
<a name="l00602"></a>00602             <span class="comment">// best_p : the best position the particle ever had</span>
<a name="l00603"></a>00603             <span class="comment">// best_g : the best position the neighborhood ever had</span>
<a name="l00604"></a>00604 
<a name="l00605"></a>00605             <span class="keywordtype">bool</span> li_equals_pi = (&amp;(this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a1aaae385ccca7c02f4ed88b510063c27">getBestPosition</a>()) == this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#ae67a14bbe108cf5e6d1d45ce23923b91">getNeighborhood</a>()-&gt;<a class="code" href="classpopot_1_1PSO_1_1neighborhood_1_1Neighborhood.html#a252939087d94296da4422bd5b6d22f85">getBest</a>());
<a name="l00606"></a>00606             <span class="keywordtype">double</span> r1,r2;
<a name="l00607"></a>00607             <span class="keywordflow">if</span>(li_equals_pi)
<a name="l00608"></a>00608               {
<a name="l00609"></a>00609                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00610"></a>00610                   {
<a name="l00611"></a>00611                     r1 = <a class="code" href="namespacepopot_1_1math.html#aff66c3835eec2f4653b273e25e8c841b">popot::math::uniform_random</a>(0.0,PARTICLE_PARAMS::c());
<a name="l00612"></a>00612                     this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#af5af1fff27bfe5156633acb8e0f8acdf">setVelocity</a>(i, PARTICLE_PARAMS::w() * this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#afae4802e0e1ebe2e9396671f48513d10">getVelocity</a>(i)
<a name="l00613"></a>00613                                       + r1 * (this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a1aaae385ccca7c02f4ed88b510063c27">getBestPosition</a>().getPosition(i) - this-&gt;getPosition(i)));
<a name="l00614"></a>00614                   }
<a name="l00615"></a>00615               }
<a name="l00616"></a>00616             <span class="keywordflow">else</span>
<a name="l00617"></a>00617               {
<a name="l00618"></a>00618                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00619"></a>00619                   {
<a name="l00620"></a>00620                     r1 = <a class="code" href="namespacepopot_1_1math.html#aff66c3835eec2f4653b273e25e8c841b">popot::math::uniform_random</a>(0.0,PARTICLE_PARAMS::c());
<a name="l00621"></a>00621                     r2 = <a class="code" href="namespacepopot_1_1math.html#aff66c3835eec2f4653b273e25e8c841b">popot::math::uniform_random</a>(0.0,PARTICLE_PARAMS::c());
<a name="l00622"></a>00622                     this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#af5af1fff27bfe5156633acb8e0f8acdf">setVelocity</a>(i, PARTICLE_PARAMS::w() * this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#afae4802e0e1ebe2e9396671f48513d10">getVelocity</a>(i)
<a name="l00623"></a>00623                                       + r1 * (this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a1aaae385ccca7c02f4ed88b510063c27">getBestPosition</a>().getPosition(i) - this-&gt;getPosition(i))
<a name="l00624"></a>00624                                       + r2 * (this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#ae67a14bbe108cf5e6d1d45ce23923b91">getNeighborhood</a>()-&gt;getBest()-&gt;getPosition(i) - this-&gt;getPosition(i)));
<a name="l00625"></a>00625                   }
<a name="l00626"></a>00626               }
<a name="l00627"></a>00627           }
<a name="l00628"></a>00628         };
<a name="l00629"></a>00629 
<a name="l00630"></a>00630 
<a name="l00638"></a>00638       <span class="keyword">template</span>&lt; <span class="keyword">typename</span> PROBLEM, <span class="keyword">typename</span> PARTICLE_PARAMS, <span class="keyword">typename</span> POSITION_INITIALIZER=popot::PSO::initializer::PositionUniformRandom, <span class="keyword">typename</span> VELOCITY_INITIALIZER=popot::PSO::initializer::VelocitySPSO2011&gt;
<a name="l00639"></a>00639         <span class="keyword">class </span>SPSO2011Particle : <span class="keyword">public</span> Particle&lt;PROBLEM, POSITION_INITIALIZER, VELOCITY_INITIALIZER &gt;
<a name="l00640"></a>00640  
<a name="l00641"></a>00641         {
<a name="l00642"></a>00642           <span class="keyword">typedef</span> Particle&lt;PROBLEM, POSITION_INITIALIZER, VELOCITY_INITIALIZER &gt; TSuper;
<a name="l00643"></a>00643 
<a name="l00644"></a>00644           <span class="keywordtype">double</span> * xpi;
<a name="l00645"></a>00645           <span class="keywordtype">double</span> * p1;
<a name="l00646"></a>00646           <span class="keywordtype">double</span> * p2;
<a name="l00647"></a>00647           <span class="keywordtype">double</span> * gr;
<a name="l00648"></a>00648         <span class="keyword">public</span>:
<a name="l00649"></a>00649 
<a name="l00650"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2011Particle.html#a2e0c0aebb8fd7d939f8a11839b408614">00650</a>         <a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2011Particle.html#a2e0c0aebb8fd7d939f8a11839b408614">SPSO2011Particle</a>(<span class="keywordtype">void</span>) : <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>()
<a name="l00651"></a>00651             {
<a name="l00652"></a>00652               xpi = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension];
<a name="l00653"></a>00653               p1 = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension];
<a name="l00654"></a>00654               p2 = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension];
<a name="l00655"></a>00655               gr = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension];
<a name="l00656"></a>00656             }
<a name="l00657"></a>00657 
<a name="l00661"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2011Particle.html#a69bfc21e4665a9937b74dd1efc452565">00661</a>           <span class="keyword">virtual</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2011Particle.html#a69bfc21e4665a9937b74dd1efc452565">~SPSO2011Particle</a>(<span class="keywordtype">void</span>)
<a name="l00662"></a>00662             {
<a name="l00663"></a>00663               <span class="keyword">delete</span>[] xpi;
<a name="l00664"></a>00664               <span class="keyword">delete</span>[] p1;
<a name="l00665"></a>00665               <span class="keyword">delete</span>[] p2;
<a name="l00666"></a>00666               <span class="keyword">delete</span>[] gr;
<a name="l00667"></a>00667             }
<a name="l00668"></a>00668 
<a name="l00672"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2011Particle.html#ab2dff03d7ee1694bbae68bdba883d330">00672</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2011Particle.html#ab2dff03d7ee1694bbae68bdba883d330">updatePosition</a>(<span class="keywordtype">void</span>)
<a name="l00673"></a>00673           {
<a name="l00674"></a>00674             <span class="comment">// Here it is simply : p_{k+1} = p_k + v_k</span>
<a name="l00675"></a>00675             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00676"></a>00676               this-&gt;setPosition(i, this-&gt;getPosition(i) + this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#afae4802e0e1ebe2e9396671f48513d10">getVelocity</a>(i));
<a name="l00677"></a>00677           }
<a name="l00678"></a>00678 
<a name="l00682"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2011Particle.html#afe097c3313243d269b9acfd6bfaa45a1">00682</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2011Particle.html#afe097c3313243d269b9acfd6bfaa45a1">updateVelocity</a>(<span class="keywordtype">void</span>)
<a name="l00683"></a>00683           {
<a name="l00684"></a>00684             <span class="comment">// The update of the velocity is done according to the equation :</span>
<a name="l00685"></a>00685             <span class="comment">// v_i(t+1) = w v_i(t) + x&#39;_i(t) - x_i(t)</span>
<a name="l00686"></a>00686             <span class="comment">// where x&#39;_i is normally sampled from the hypersphere (Gi, Ri)</span>
<a name="l00687"></a>00687             <span class="comment">// with Gi the center and Ri the radius and</span>
<a name="l00688"></a>00688             <span class="comment">// Gi = 1/3 ( x_i + (x_i + c(p_i - x_i)) + (x_i + c(l_i - x_i)))</span>
<a name="l00689"></a>00689             <span class="comment">//    = 1/3 ( x_i +          p1          +            p2     )))</span>
<a name="l00690"></a>00690             <span class="comment">// or </span>
<a name="l00691"></a>00691             <span class="comment">// Gi = 1/2 (x_i + (x_i + c(p_i - x_i))) if p_i == l_i</span>
<a name="l00692"></a>00692             <span class="comment">//    = 1/2 (x_i +          p1         )</span>
<a name="l00693"></a>00693             <span class="comment">// Ri = ||G_i - x_i||</span>
<a name="l00694"></a>00694 
<a name="l00695"></a>00695             <span class="comment">// We first check if the local best and personal best are identical by computing the norm of the difference</span>
<a name="l00696"></a>00696             <span class="comment">// between both positions</span>
<a name="l00697"></a>00697             <span class="comment">// This can be done with pointer comparison</span>
<a name="l00698"></a>00698             <span class="comment">// as the neighborhood holds a pointer to the best personal best</span>
<a name="l00699"></a>00699             <span class="keywordtype">bool</span> li_equals_pi = (&amp;(this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a1aaae385ccca7c02f4ed88b510063c27">getBestPosition</a>()) == this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#ae67a14bbe108cf5e6d1d45ce23923b91">getNeighborhood</a>()-&gt;<a class="code" href="classpopot_1_1PSO_1_1neighborhood_1_1Neighborhood.html#a252939087d94296da4422bd5b6d22f85">getBest</a>());
<a name="l00700"></a>00700 
<a name="l00701"></a>00701             <span class="comment">// First position</span>
<a name="l00702"></a>00702             <span class="comment">// p1 = xi + c * (pi - xi)</span>
<a name="l00703"></a>00703             <span class="comment">// where pi is the personal best position</span>
<a name="l00704"></a>00704             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00705"></a>00705               p1[i] = this-&gt;getPosition(i) + PARTICLE_PARAMS::c() *(this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a1aaae385ccca7c02f4ed88b510063c27">getBestPosition</a>().<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a7612290063de657dafec99cb35ee4032">getPosition</a>(i) - this-&gt;getPosition(i));
<a name="l00706"></a>00706           
<a name="l00707"></a>00707             <span class="comment">// Second position</span>
<a name="l00708"></a>00708             <span class="comment">// p2 = xi + c * (li - xi)</span>
<a name="l00709"></a>00709             <span class="comment">// where li is the local best position (within the neighborhood)</span>
<a name="l00710"></a>00710             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00711"></a>00711               p2[i] = this-&gt;getPosition(i) + PARTICLE_PARAMS::c() *(this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#ae67a14bbe108cf5e6d1d45ce23923b91">getNeighborhood</a>()-&gt;<a class="code" href="classpopot_1_1PSO_1_1neighborhood_1_1Neighborhood.html#a252939087d94296da4422bd5b6d22f85">getBest</a>()-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a7612290063de657dafec99cb35ee4032">getPosition</a>(i) - this-&gt;getPosition(i));
<a name="l00712"></a>00712           
<a name="l00713"></a>00713             <span class="comment">// Compute the gravity center of p1, p2 and xi</span>
<a name="l00714"></a>00714             <span class="keywordflow">if</span>(!li_equals_pi)
<a name="l00715"></a>00715               {
<a name="l00716"></a>00716                 <span class="comment">// We here consider p1, p2 and xi</span>
<a name="l00717"></a>00717                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00718"></a>00718                   gr[i] = 1.0/3.0 * (this-&gt;getPosition(i) + p1[i] + p2[i]);
<a name="l00719"></a>00719               }
<a name="l00720"></a>00720             <span class="keywordflow">else</span>
<a name="l00721"></a>00721               {
<a name="l00722"></a>00722                 <span class="comment">// We here consider only p1 (or p2, since they are equal) and xi</span>
<a name="l00723"></a>00723                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00724"></a>00724                   gr[i] = 1.0/2.0 * (this-&gt;getPosition(i) + p1[i]);
<a name="l00725"></a>00725               }
<a name="l00726"></a>00726 
<a name="l00727"></a>00727             <span class="comment">// And the radius of the hypersphere</span>
<a name="l00728"></a>00728             <span class="keywordtype">double</span> ri = 0.0;
<a name="l00729"></a>00729             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00730"></a>00730               ri += (gr[i] - this-&gt;getPosition(i))*(gr[i] - this-&gt;getPosition(i));
<a name="l00731"></a>00731             ri = sqrt(ri);
<a name="l00732"></a>00732 
<a name="l00733"></a>00733             <span class="comment">// Compute the auxiliary position x&#39;_i randomly within the hypersphere (gr, ri);</span>
<a name="l00734"></a>00734             <span class="comment">// To uniformely sample from the hypersphere we uniformely sample a direction</span>
<a name="l00735"></a>00735             <span class="keywordtype">double</span> norm = 0.0;
<a name="l00736"></a>00736             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00737"></a>00737               {
<a name="l00738"></a>00738                 xpi[i] = <a class="code" href="namespacepopot_1_1math.html#a379cb433fc4a216e75252d7278c161a7">popot::math::normal</a>(0.0,1.0);
<a name="l00739"></a>00739                 norm += xpi[i] * xpi[i];
<a name="l00740"></a>00740               }
<a name="l00741"></a>00741             norm = sqrt(norm);
<a name="l00742"></a>00742           
<a name="l00743"></a>00743             <span class="comment">// And then scale by a random radius</span>
<a name="l00744"></a>00744             <span class="keywordtype">double</span> r = <a class="code" href="namespacepopot_1_1math.html#aff66c3835eec2f4653b273e25e8c841b">popot::math::uniform_random</a>(0.0,1.0);
<a name="l00745"></a>00745             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00746"></a>00746               xpi[i] =  gr[i] + r * ri * xpi[i] / norm;
<a name="l00747"></a>00747 
<a name="l00748"></a>00748             <span class="comment">// And then update the velocity</span>
<a name="l00749"></a>00749             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00750"></a>00750               this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#af5af1fff27bfe5156633acb8e0f8acdf">setVelocity</a>(i, PARTICLE_PARAMS::w() * this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#afae4802e0e1ebe2e9396671f48513d10">getVelocity</a>(i)
<a name="l00751"></a>00751                                 + xpi[i] - this-&gt;getPosition(i));
<a name="l00752"></a>00752           }
<a name="l00753"></a>00753 
<a name="l00754"></a>00754 
<a name="l00759"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2011Particle.html#a51098ccc2761806d3c1b0e92d1b30eac">00759</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2011Particle.html#a51098ccc2761806d3c1b0e92d1b30eac">confine</a>(<span class="keywordtype">void</span>)
<a name="l00760"></a>00760           {
<a name="l00761"></a>00761             <span class="comment">// In case the position is out of the bounds</span>
<a name="l00762"></a>00762             <span class="comment">// we reset the velocities</span>
<a name="l00763"></a>00763             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00764"></a>00764               {
<a name="l00765"></a>00765                 <span class="keywordflow">if</span>((this-&gt;getPosition(i) &lt; PROBLEM::get_lbound(i)))
<a name="l00766"></a>00766                   {
<a name="l00767"></a>00767                     this-&gt;setPosition(i, PROBLEM::get_lbound(i));
<a name="l00768"></a>00768                     this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#af5af1fff27bfe5156633acb8e0f8acdf">setVelocity</a>(i,-0.5*this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#afae4802e0e1ebe2e9396671f48513d10">getVelocity</a>(i));
<a name="l00769"></a>00769                   }
<a name="l00770"></a>00770                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(this-&gt;getPosition(i) &gt; PROBLEM::get_ubound(i))
<a name="l00771"></a>00771                   {               
<a name="l00772"></a>00772                     this-&gt;setPosition(i, PROBLEM::get_ubound(i));
<a name="l00773"></a>00773                     this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#af5af1fff27bfe5156633acb8e0f8acdf">setVelocity</a>(i,-0.5*this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#afae4802e0e1ebe2e9396671f48513d10">getVelocity</a>(i));
<a name="l00774"></a>00774                   }
<a name="l00775"></a>00775               }
<a name="l00776"></a>00776           }
<a name="l00777"></a>00777           
<a name="l00778"></a>00778 
<a name="l00779"></a>00779         };
<a name="l00780"></a>00780 
<a name="l00785"></a>00785       <span class="keyword">template</span>&lt; <span class="keyword">typename</span> PROBLEM, <span class="keyword">typename</span> PARTICLE_PARAMS, <span class="keyword">typename</span> POSITION_INITIALIZER=popot::PSO::initializer::PositionUniformRandom, <span class="keyword">typename</span> VELOCITY_INITIALIZER=popot::PSO::initializer::VelocitySPSO2011&gt;
<a name="l00786"></a>00786         <span class="keyword">class </span>BenchSPSO2011Particle : <span class="keyword">public</span> Particle&lt;PROBLEM, POSITION_INITIALIZER, VELOCITY_INITIALIZER &gt;
<a name="l00787"></a>00787  
<a name="l00788"></a>00788         {
<a name="l00789"></a>00789           <span class="keyword">typedef</span> Particle&lt;PROBLEM, POSITION_INITIALIZER, VELOCITY_INITIALIZER&gt; TSuper;
<a name="l00790"></a>00790 
<a name="l00791"></a>00791           <span class="keywordtype">double</span> * xpi;
<a name="l00792"></a>00792           <span class="keywordtype">double</span> * p1;
<a name="l00793"></a>00793           <span class="keywordtype">double</span> * p2;
<a name="l00794"></a>00794           <span class="keywordtype">double</span> * gr;
<a name="l00795"></a>00795         <span class="keyword">public</span>:
<a name="l00796"></a>00796 
<a name="l00797"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BenchSPSO2011Particle.html#af6a3436dd710df49cf7213958a529424">00797</a>         <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BenchSPSO2011Particle.html#af6a3436dd710df49cf7213958a529424">BenchSPSO2011Particle</a>(<span class="keywordtype">void</span>) : <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>()
<a name="l00798"></a>00798             {
<a name="l00799"></a>00799               xpi = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension];
<a name="l00800"></a>00800               p1 = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension];
<a name="l00801"></a>00801               p2 = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension];
<a name="l00802"></a>00802               gr = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension];
<a name="l00803"></a>00803             }
<a name="l00804"></a>00804 
<a name="l00808"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BenchSPSO2011Particle.html#ac304a72cb45ecb27b0c397d04af99125">00808</a>           <span class="keyword">virtual</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BenchSPSO2011Particle.html#ac304a72cb45ecb27b0c397d04af99125">~BenchSPSO2011Particle</a>(<span class="keywordtype">void</span>)
<a name="l00809"></a>00809             {
<a name="l00810"></a>00810               <span class="keyword">delete</span>[] xpi;
<a name="l00811"></a>00811               <span class="keyword">delete</span>[] p1;
<a name="l00812"></a>00812               <span class="keyword">delete</span>[] p2;
<a name="l00813"></a>00813               <span class="keyword">delete</span>[] gr;
<a name="l00814"></a>00814             }
<a name="l00815"></a>00815 
<a name="l00816"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BenchSPSO2011Particle.html#af5bc7145930af0770c368b7dd88d6e76">00816</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BenchSPSO2011Particle.html#af5bc7145930af0770c368b7dd88d6e76">init</a>(<span class="keywordtype">void</span>)
<a name="l00817"></a>00817           {
<a name="l00818"></a>00818             <span class="keywordtype">double</span> params[3];
<a name="l00819"></a>00819             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00820"></a>00820               {
<a name="l00821"></a>00821                 this-&gt;setPosition(i,POSITION_INITIALIZER::init(PROBLEM::get_lbound(i),PROBLEM::get_ubound(i)));
<a name="l00822"></a>00822 
<a name="l00823"></a>00823                 params[0] = PROBLEM::get_lbound(i);
<a name="l00824"></a>00824                 params[1] = PROBLEM::get_ubound(i);
<a name="l00825"></a>00825                 params[2] = this-&gt;getPosition(i);
<a name="l00826"></a>00826                 this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#af5af1fff27bfe5156633acb8e0f8acdf">setVelocity</a>(i, VELOCITY_INITIALIZER::init(params));
<a name="l00827"></a>00827               }
<a name="l00828"></a>00828 
<a name="l00829"></a>00829             this-&gt;evaluateFitness();
<a name="l00830"></a>00830 
<a name="l00831"></a>00831             <span class="comment">// Set the best particle to the current position</span>
<a name="l00832"></a>00832             this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a7f1a0546236dac2736a185efb0d05ea4">_best_position</a> = *<span class="keyword">this</span>;
<a name="l00833"></a>00833           }
<a name="l00834"></a>00834 
<a name="l00838"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BenchSPSO2011Particle.html#a0a4e63f892b8ee68222f26598dbef8f6">00838</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BenchSPSO2011Particle.html#a0a4e63f892b8ee68222f26598dbef8f6">updatePosition</a>(<span class="keywordtype">void</span>)
<a name="l00839"></a>00839           {
<a name="l00840"></a>00840             <span class="comment">// Here it is simply : p_{k+1} = p_k + v_k</span>
<a name="l00841"></a>00841             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00842"></a>00842               this-&gt;setPosition(i, this-&gt;getPosition(i) + this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#afae4802e0e1ebe2e9396671f48513d10">getVelocity</a>(i));
<a name="l00843"></a>00843             <span class="keywordflow">if</span>(<a class="code" href="popot_8h.html#ab33dc5d314404556a2693e57728abd85">VERBOSE_BENCH</a>)
<a name="l00844"></a>00844               {
<a name="l00845"></a>00845                 std::cout &lt;&lt; <span class="stringliteral">&quot;New position : &quot;</span> ;
<a name="l00846"></a>00846                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00847"></a>00847                   std::cout &lt;&lt; this-&gt;getPosition(i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00848"></a>00848                 std::cout &lt;&lt; std::endl;
<a name="l00849"></a>00849               }
<a name="l00850"></a>00850           }
<a name="l00851"></a>00851 
<a name="l00855"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BenchSPSO2011Particle.html#a830d40cd5b769b6484a6eb2b647f9fc7">00855</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BenchSPSO2011Particle.html#a830d40cd5b769b6484a6eb2b647f9fc7">updateVelocity</a>(<span class="keywordtype">void</span>)
<a name="l00856"></a>00856           {
<a name="l00857"></a>00857 
<a name="l00858"></a>00858             <span class="keywordflow">if</span>(<a class="code" href="popot_8h.html#ab33dc5d314404556a2693e57728abd85">VERBOSE_BENCH</a>)
<a name="l00859"></a>00859               {
<a name="l00860"></a>00860                 std::cout &lt;&lt; <span class="stringliteral">&quot;Position of the best informant (over &quot;</span> &lt;&lt; this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#ae67a14bbe108cf5e6d1d45ce23923b91">getNeighborhood</a>()-&gt;<a class="code" href="classpopot_1_1PSO_1_1neighborhood_1_1Neighborhood.html#a4a0e5f4fc3cdae4192c525acc67a067b">size</a>() &lt;&lt; <span class="stringliteral">&quot;) : &quot;</span> &lt;&lt; this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#ae67a14bbe108cf5e6d1d45ce23923b91">getNeighborhood</a>()-&gt;<a class="code" href="classpopot_1_1PSO_1_1neighborhood_1_1Neighborhood.html#a252939087d94296da4422bd5b6d22f85">getBest</a>()-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#ac85ece6d8119d4867e1c8cb15d6ce2ba">getFitness</a>() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> ;
<a name="l00861"></a>00861                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00862"></a>00862                   std::cout &lt;&lt; this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#ae67a14bbe108cf5e6d1d45ce23923b91">getNeighborhood</a>()-&gt;<a class="code" href="classpopot_1_1PSO_1_1neighborhood_1_1Neighborhood.html#a252939087d94296da4422bd5b6d22f85">getBest</a>()-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a7612290063de657dafec99cb35ee4032">getPosition</a>(i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span> ;
<a name="l00863"></a>00863                 std::cout &lt;&lt; std::endl;
<a name="l00864"></a>00864 
<a name="l00865"></a>00865                 std::cout &lt;&lt; <span class="stringliteral">&quot;Old velocity : &quot;</span> ;
<a name="l00866"></a>00866                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00867"></a>00867                   std::cout &lt;&lt; this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#afae4802e0e1ebe2e9396671f48513d10">getVelocity</a>(i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00868"></a>00868                 std::cout &lt;&lt; std::endl;
<a name="l00869"></a>00869               }
<a name="l00870"></a>00870 
<a name="l00871"></a>00871             <span class="comment">// The update of the velocity is done according to the equation :</span>
<a name="l00872"></a>00872             <span class="comment">// v_i(t+1) = w v_i(t) + x&#39;_i(t) - x_i(t)</span>
<a name="l00873"></a>00873             <span class="comment">// where x&#39;_i is normally sampled from the hypersphere (Gi, Ri)</span>
<a name="l00874"></a>00874             <span class="comment">// with Gi the center and Ri the radius and</span>
<a name="l00875"></a>00875             <span class="comment">// Gi = 1/3 ( x_i + (x_i + c(p_i - x_i)) + (x_i + c(l_i - x_i)))</span>
<a name="l00876"></a>00876             <span class="comment">//    = 1/3 ( x_i +          p1          +            p2     )))</span>
<a name="l00877"></a>00877             <span class="comment">// or </span>
<a name="l00878"></a>00878             <span class="comment">// Gi = 1/2 (x_i + (x_i + c(p_i - x_i))) if p_i == l_i</span>
<a name="l00879"></a>00879             <span class="comment">//    = 1/2 (x_i +          p1         )</span>
<a name="l00880"></a>00880             <span class="comment">// Ri = ||G_i - x_i||</span>
<a name="l00881"></a>00881 
<a name="l00882"></a>00882             <span class="comment">// We first check if the local best and personal best are identical by computing the norm of the difference</span>
<a name="l00883"></a>00883             <span class="comment">// between both positions</span>
<a name="l00884"></a>00884             <span class="comment">// This can be done with pointer comparison</span>
<a name="l00885"></a>00885             <span class="comment">// as the neighborhood holds a pointer to the best personal best</span>
<a name="l00886"></a>00886             <span class="keywordtype">bool</span> li_equals_pi = (&amp;(this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a1aaae385ccca7c02f4ed88b510063c27">getBestPosition</a>()) == this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#ae67a14bbe108cf5e6d1d45ce23923b91">getNeighborhood</a>()-&gt;<a class="code" href="classpopot_1_1PSO_1_1neighborhood_1_1Neighborhood.html#a252939087d94296da4422bd5b6d22f85">getBest</a>());
<a name="l00887"></a>00887 
<a name="l00888"></a>00888             <span class="keywordflow">if</span>(<a class="code" href="popot_8h.html#ab33dc5d314404556a2693e57728abd85">VERBOSE_BENCH</a>)
<a name="l00889"></a>00889               {
<a name="l00890"></a>00890                 <span class="keywordflow">if</span>(li_equals_pi)
<a name="l00891"></a>00891                   std::cout &lt;&lt; <span class="stringliteral">&quot;The particle IIISSSS its own local best&quot;</span> &lt;&lt; std::endl;
<a name="l00892"></a>00892               }
<a name="l00893"></a>00893 
<a name="l00894"></a>00894             <span class="keywordflow">if</span>(<a class="code" href="popot_8h.html#ab33dc5d314404556a2693e57728abd85">VERBOSE_BENCH</a>)
<a name="l00895"></a>00895               {
<a name="l00896"></a>00896                 std::cout &lt;&lt; <span class="stringliteral">&quot;BW = .... nb_calls = &quot;</span> &lt;&lt; RNG_GENERATOR::nb_calls &lt;&lt; std::endl;
<a name="l00897"></a>00897               }
<a name="l00898"></a>00898 
<a name="l00899"></a>00899             <span class="comment">// First position</span>
<a name="l00900"></a>00900             <span class="comment">// p1 = xi + c * (pi - xi)</span>
<a name="l00901"></a>00901             <span class="comment">// where pi is the personal best position</span>
<a name="l00902"></a>00902             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00903"></a>00903               p1[i] = this-&gt;getPosition(i) + PARTICLE_PARAMS::c() *(this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a1aaae385ccca7c02f4ed88b510063c27">getBestPosition</a>().<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a7612290063de657dafec99cb35ee4032">getPosition</a>(i) - this-&gt;getPosition(i));
<a name="l00904"></a>00904           
<a name="l00905"></a>00905             <span class="comment">// Second position</span>
<a name="l00906"></a>00906             <span class="comment">// p2 = xi + c * (li - xi)</span>
<a name="l00907"></a>00907             <span class="comment">// where li is the local best position (within the neighborhood)</span>
<a name="l00908"></a>00908             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00909"></a>00909               p2[i] = this-&gt;getPosition(i) + PARTICLE_PARAMS::c() *(this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#ae67a14bbe108cf5e6d1d45ce23923b91">getNeighborhood</a>()-&gt;<a class="code" href="classpopot_1_1PSO_1_1neighborhood_1_1Neighborhood.html#a252939087d94296da4422bd5b6d22f85">getBest</a>()-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a7612290063de657dafec99cb35ee4032">getPosition</a>(i) - this-&gt;getPosition(i));
<a name="l00910"></a>00910           
<a name="l00911"></a>00911             <span class="comment">// Compute the gravity center of p1, p2 and xi</span>
<a name="l00912"></a>00912             <span class="keywordflow">if</span>(!li_equals_pi)
<a name="l00913"></a>00913               {
<a name="l00914"></a>00914                 <span class="comment">// We here consider p1, p2 and xi</span>
<a name="l00915"></a>00915                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00916"></a>00916                   gr[i] = 1.0/3.0 * (this-&gt;getPosition(i) + p1[i] + p2[i]);
<a name="l00917"></a>00917               }
<a name="l00918"></a>00918             <span class="keywordflow">else</span>
<a name="l00919"></a>00919               {
<a name="l00920"></a>00920                 <span class="comment">// We here consider only p1 (or p2, since they are equal) and xi</span>
<a name="l00921"></a>00921                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00922"></a>00922                   gr[i] = 1.0/2.0 * (this-&gt;getPosition(i) + p1[i]);
<a name="l00923"></a>00923               }
<a name="l00924"></a>00924 
<a name="l00925"></a>00925             <span class="comment">// And the radius of the hypersphere</span>
<a name="l00926"></a>00926             <span class="keywordtype">double</span> ri = 0.0;
<a name="l00927"></a>00927             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00928"></a>00928               ri += (gr[i] - this-&gt;getPosition(i))*(gr[i] - this-&gt;getPosition(i));
<a name="l00929"></a>00929             ri = sqrt(ri);
<a name="l00930"></a>00930 
<a name="l00931"></a>00931             <span class="comment">// Compute the auxiliary position x&#39;_i randomly within the hypersphere (gr, ri);</span>
<a name="l00932"></a>00932             <span class="comment">// To uniformely sample from the hypersphere we uniformely sample a direction</span>
<a name="l00933"></a>00933             <span class="keywordtype">double</span> norm = 0.0;
<a name="l00934"></a>00934             <span class="keywordflow">if</span>(<a class="code" href="popot_8h.html#ab33dc5d314404556a2693e57728abd85">VERBOSE_BENCH</a>)
<a name="l00935"></a>00935               {
<a name="l00936"></a>00936                 std::cout &lt;&lt; <span class="stringliteral">&quot;Nb RNG calls before alea normal: &quot;</span> &lt;&lt; RNG_GENERATOR::nb_calls &lt;&lt; std::endl;
<a name="l00937"></a>00937               }
<a name="l00938"></a>00938 
<a name="l00939"></a>00939             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00940"></a>00940               {
<a name="l00941"></a>00941                 xpi[i] = <a class="code" href="namespacepopot_1_1math.html#a490555fab3908934d1318c3b35c1568a">popot::math::normal_spso2011</a>(0.0,1.0);
<a name="l00942"></a>00942                 norm += xpi[i] * xpi[i];
<a name="l00943"></a>00943               }
<a name="l00944"></a>00944             norm = sqrt(norm);
<a name="l00945"></a>00945 
<a name="l00946"></a>00946             <span class="keywordflow">if</span>(<a class="code" href="popot_8h.html#ab33dc5d314404556a2693e57728abd85">VERBOSE_BENCH</a>)
<a name="l00947"></a>00947               {
<a name="l00948"></a>00948                 std::cout &lt;&lt; <span class="stringliteral">&quot;Alea normal : &quot;</span> ;
<a name="l00949"></a>00949                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00950"></a>00950                   std::cout &lt;&lt; xpi[i] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00951"></a>00951                 std::cout &lt;&lt; std::endl;
<a name="l00952"></a>00952               
<a name="l00953"></a>00953                 std::cout &lt;&lt; <span class="stringliteral">&quot;Rad = &quot;</span> &lt;&lt; ri &lt;&lt; std::endl;
<a name="l00954"></a>00954               }
<a name="l00955"></a>00955 
<a name="l00956"></a>00956             <span class="comment">// And then scale by a random radius</span>
<a name="l00957"></a>00957             <span class="keywordtype">double</span> r = <a class="code" href="namespacepopot_1_1math.html#aff66c3835eec2f4653b273e25e8c841b">popot::math::uniform_random</a>(0.0,1.0);
<a name="l00958"></a>00958             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00959"></a>00959               xpi[i] =  gr[i] +  r * ri * xpi[i] / norm;
<a name="l00960"></a>00960 
<a name="l00961"></a>00961             <span class="comment">// And then update the velocity</span>
<a name="l00962"></a>00962             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00963"></a>00963               this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#af5af1fff27bfe5156633acb8e0f8acdf">setVelocity</a>(i, PARTICLE_PARAMS::w() * this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#afae4802e0e1ebe2e9396671f48513d10">getVelocity</a>(i)
<a name="l00964"></a>00964                                 + xpi[i] - this-&gt;getPosition(i));
<a name="l00965"></a>00965             <span class="keywordflow">if</span>(<a class="code" href="popot_8h.html#ab33dc5d314404556a2693e57728abd85">VERBOSE_BENCH</a>)
<a name="l00966"></a>00966               {
<a name="l00967"></a>00967                 std::cout &lt;&lt; <span class="stringliteral">&quot;New velocity : &quot;</span> ;
<a name="l00968"></a>00968                 <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00969"></a>00969                   std::cout &lt;&lt; this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#afae4802e0e1ebe2e9396671f48513d10">getVelocity</a>(i) &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;
<a name="l00970"></a>00970                 std::cout &lt;&lt; std::endl;
<a name="l00971"></a>00971                 std::cout &lt;&lt; <span class="stringliteral">&quot;Nb RNG calls after new velocity: &quot;</span> &lt;&lt; RNG_GENERATOR::nb_calls &lt;&lt; std::endl;
<a name="l00972"></a>00972               }
<a name="l00973"></a>00973 
<a name="l00974"></a>00974           }
<a name="l00975"></a>00975 
<a name="l00976"></a>00976 
<a name="l00981"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BenchSPSO2011Particle.html#a85e4b6030703128b226e1f20b6a999e5">00981</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BenchSPSO2011Particle.html#a85e4b6030703128b226e1f20b6a999e5">confine</a>(<span class="keywordtype">void</span>)
<a name="l00982"></a>00982           {
<a name="l00983"></a>00983             <span class="comment">// In case the position is out of the bounds</span>
<a name="l00984"></a>00984             <span class="comment">// we reset the velocities</span>
<a name="l00985"></a>00985             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l00986"></a>00986               {
<a name="l00987"></a>00987                 <span class="keywordflow">if</span>((this-&gt;getPosition(i) &lt; PROBLEM::get_lbound(i)))
<a name="l00988"></a>00988                   {
<a name="l00989"></a>00989                     this-&gt;setPosition(i, PROBLEM::get_lbound(i));
<a name="l00990"></a>00990                     this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#af5af1fff27bfe5156633acb8e0f8acdf">setVelocity</a>(i,-0.5*this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#afae4802e0e1ebe2e9396671f48513d10">getVelocity</a>(i));
<a name="l00991"></a>00991                   }
<a name="l00992"></a>00992                 <span class="keywordflow">else</span> <span class="keywordflow">if</span>(this-&gt;getPosition(i) &gt; PROBLEM::get_ubound(i))
<a name="l00993"></a>00993                   {               
<a name="l00994"></a>00994                     this-&gt;setPosition(i, PROBLEM::get_ubound(i));
<a name="l00995"></a>00995                     this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#af5af1fff27bfe5156633acb8e0f8acdf">setVelocity</a>(i,-0.5*this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#afae4802e0e1ebe2e9396671f48513d10">getVelocity</a>(i));
<a name="l00996"></a>00996                   }
<a name="l00997"></a>00997               }
<a name="l00998"></a>00998           }
<a name="l00999"></a>00999         };
<a name="l01000"></a>01000 
<a name="l01001"></a>01001 
<a name="l01010"></a>01010       <span class="keyword">template</span>&lt; <span class="keyword">typename</span> PROBLEM, <span class="keyword">typename</span> PARTICLE_PARAMS, <span class="keyword">typename</span> POSITION_INITIALIZER=popot::PSO::initializer::PositionUniformRandom, <span class="keyword">typename</span> VELOCITY_INITIALIZER=popot::PSO::initializer::VelocityHalfDiff&gt;
<a name="l01011"></a>01011         <span class="keyword">class </span>StochasticSPSO2006Particle : <span class="keyword">public</span> SPSO2006Particle&lt;PROBLEM, PARTICLE_PARAMS, POSITION_INITIALIZER, VELOCITY_INITIALIZER&gt;
<a name="l01012"></a>01012  
<a name="l01013"></a>01013         {
<a name="l01014"></a>01014           <span class="keyword">typedef</span> SPSO2006Particle&lt;PROBLEM, PARTICLE_PARAMS, POSITION_INITIALIZER, VELOCITY_INITIALIZER&gt; TSuper;
<a name="l01015"></a>01015 
<a name="l01016"></a>01016         <span class="keyword">public</span>:
<a name="l01017"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1StochasticSPSO2006Particle.html#a99f2bdf34e4871040bb72d8ca16a524e">01017</a>         <a class="code" href="classpopot_1_1PSO_1_1particle_1_1StochasticSPSO2006Particle.html#a99f2bdf34e4871040bb72d8ca16a524e">StochasticSPSO2006Particle</a>() : <a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2006Particle.html">TSuper</a>()
<a name="l01018"></a>01018             {
<a name="l01019"></a>01019             }
<a name="l01020"></a>01020 
<a name="l01024"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1StochasticSPSO2006Particle.html#aed00a306216a234aaa89db886d4dd231">01024</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1StochasticSPSO2006Particle.html#aed00a306216a234aaa89db886d4dd231">updateBestPosition</a>(<span class="keywordtype">void</span>)
<a name="l01025"></a>01025           {
<a name="l01026"></a>01026             <span class="comment">// Reevalute the fitness of the personal best before</span>
<a name="l01027"></a>01027             <span class="comment">// possibly changing the personal best</span>
<a name="l01028"></a>01028             this-&gt;_best_position.evaluateFitness();
<a name="l01029"></a>01029 
<a name="l01030"></a>01030             <span class="comment">// Update the best position the particle ever had</span>
<a name="l01031"></a>01031             <span class="comment">// with a copy of the current position</span>
<a name="l01032"></a>01032             <span class="keywordflow">if</span>(this-&gt;compare(this-&gt;getBestPosition()) &lt; 0)
<a name="l01033"></a>01033               this-&gt;_best_position = *<span class="keyword">this</span>;
<a name="l01034"></a>01034           }
<a name="l01035"></a>01035         };
<a name="l01036"></a>01036 
<a name="l01045"></a>01045       <span class="keyword">template</span>&lt; <span class="keyword">typename</span> PROBLEM, <span class="keyword">typename</span> PARTICLE_PARAMS, <span class="keyword">typename</span> POSITION_INITIALIZER=popot::PSO::initializer::PositionUniformRandom, <span class="keyword">typename</span> VELOCITY_INITIALIZER=popot::PSO::initializer::VelocitySPSO2011&gt;
<a name="l01046"></a>01046         <span class="keyword">class </span>StochasticSPSO2011Particle : <span class="keyword">public</span> SPSO2011Particle&lt;PROBLEM, PARTICLE_PARAMS, POSITION_INITIALIZER, VELOCITY_INITIALIZER&gt;
<a name="l01047"></a>01047  
<a name="l01048"></a>01048         {
<a name="l01049"></a>01049           <span class="keyword">typedef</span> SPSO2011Particle&lt;PROBLEM, PARTICLE_PARAMS, POSITION_INITIALIZER, VELOCITY_INITIALIZER&gt; TSuper;
<a name="l01050"></a>01050 
<a name="l01051"></a>01051         <span class="keyword">public</span>:
<a name="l01052"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1StochasticSPSO2011Particle.html#aed299576c35086e7ce6b389def84e9b9">01052</a>         <a class="code" href="classpopot_1_1PSO_1_1particle_1_1StochasticSPSO2011Particle.html#aed299576c35086e7ce6b389def84e9b9">StochasticSPSO2011Particle</a>() : <a class="code" href="classpopot_1_1PSO_1_1particle_1_1SPSO2011Particle.html">TSuper</a>()
<a name="l01053"></a>01053             {
<a name="l01054"></a>01054             }
<a name="l01055"></a>01055 
<a name="l01059"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1StochasticSPSO2011Particle.html#a74e0fa1c814d537490c9c3488dae3238">01059</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1StochasticSPSO2011Particle.html#a74e0fa1c814d537490c9c3488dae3238">updateBestPosition</a>(<span class="keywordtype">void</span>)
<a name="l01060"></a>01060           {
<a name="l01061"></a>01061             <span class="comment">// Reevalute the fitness of the personal best before</span>
<a name="l01062"></a>01062             <span class="comment">// possibly changing the personal best</span>
<a name="l01063"></a>01063             this-&gt;_best_position.evaluateFitness();
<a name="l01064"></a>01064 
<a name="l01065"></a>01065             <span class="comment">// Update the best position the particle ever had</span>
<a name="l01066"></a>01066             <span class="comment">// with a copy of the current position</span>
<a name="l01067"></a>01067             <span class="keywordflow">if</span>(this-&gt;compare(this-&gt;getBestPosition()) &lt; 0)
<a name="l01068"></a>01068               this-&gt;_best_position = *<span class="keyword">this</span>;
<a name="l01069"></a>01069           }
<a name="l01070"></a>01070         };
<a name="l01071"></a>01071 
<a name="l01072"></a>01072 
<a name="l01078"></a>01078       <span class="keyword">template</span>&lt; <span class="keyword">typename</span> PROBLEM, <span class="keyword">typename</span> POSITION_INITIALIZER=popot::PSO::initializer::PositionUniformRandom, <span class="keyword">typename</span> VELOCITY_INITIALIZER=popot::PSO::initializer::VelocityHalfDiff&gt;
<a name="l01079"></a>01079         <span class="keyword">class </span>BareboneParticle : <span class="keyword">public</span> Particle&lt;PROBLEM, POSITION_INITIALIZER, VELOCITY_INITIALIZER&gt;
<a name="l01080"></a>01080         {
<a name="l01081"></a>01081           <span class="keyword">typedef</span> Particle&lt;PROBLEM, POSITION_INITIALIZER, VELOCITY_INITIALIZER&gt; TSuper;
<a name="l01082"></a>01082 
<a name="l01083"></a>01083         <span class="keyword">public</span>:
<a name="l01084"></a>01084 
<a name="l01085"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BareboneParticle.html#aa9a3677155deb209acb080187c0fac42">01085</a>         <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BareboneParticle.html#aa9a3677155deb209acb080187c0fac42">BareboneParticle</a>(<span class="keywordtype">void</span>) : <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>()
<a name="l01086"></a>01086             {
<a name="l01087"></a>01087             }
<a name="l01088"></a>01088 
<a name="l01092"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BareboneParticle.html#aa24d2e99d444722947dd259658afac0f">01092</a>           <span class="keyword">virtual</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BareboneParticle.html#aa24d2e99d444722947dd259658afac0f">~BareboneParticle</a>(<span class="keywordtype">void</span>)
<a name="l01093"></a>01093             {
<a name="l01094"></a>01094             }
<a name="l01095"></a>01095 
<a name="l01099"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BareboneParticle.html#a3bd5042522e44b4663a77e24d286ddf6">01099</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BareboneParticle.html#a3bd5042522e44b4663a77e24d286ddf6">updatePosition</a>(<span class="keywordtype">void</span>)
<a name="l01100"></a>01100           {
<a name="l01101"></a>01101             <span class="comment">// Here it is simply : p_{k+1} = v_{k+1}</span>
<a name="l01102"></a>01102             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l01103"></a>01103               this-&gt;setPosition(i , this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#afae4802e0e1ebe2e9396671f48513d10">getVelocity</a>(i));
<a name="l01104"></a>01104           }
<a name="l01105"></a>01105 
<a name="l01109"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1BareboneParticle.html#a3dabbd784be283295dd3caef22db03ea">01109</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1BareboneParticle.html#a3dabbd784be283295dd3caef22db03ea">updateVelocity</a>(<span class="keywordtype">void</span>)
<a name="l01110"></a>01110           {
<a name="l01111"></a>01111             <span class="comment">// The update of the velocity is done according to the equation :</span>
<a name="l01112"></a>01112             <span class="comment">// v_{k+1} = N( (best_p+best_g)/2), sigma)</span>
<a name="l01113"></a>01113             <span class="comment">// with :</span>
<a name="l01114"></a>01114             <span class="comment">// sigma : the variance defined as |best_p_ij - best_g_ij| with</span>
<a name="l01115"></a>01115             <span class="comment">// best_p : the best position the particle ever had</span>
<a name="l01116"></a>01116             <span class="comment">// best_g : the best position the neighborhood ever had</span>
<a name="l01117"></a>01117 
<a name="l01118"></a>01118             <span class="keywordtype">double</span> mean,var;
<a name="l01119"></a>01119             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l01120"></a>01120               {
<a name="l01121"></a>01121                 mean = 0.5*(this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a1aaae385ccca7c02f4ed88b510063c27">getBestPosition</a>().<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a7612290063de657dafec99cb35ee4032">getPosition</a>(i) + this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#ae67a14bbe108cf5e6d1d45ce23923b91">getNeighborhood</a>()-&gt;<a class="code" href="classpopot_1_1PSO_1_1neighborhood_1_1Neighborhood.html#a252939087d94296da4422bd5b6d22f85">getBest</a>()-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a7612290063de657dafec99cb35ee4032">getPosition</a>(i));
<a name="l01122"></a>01122                 var = fabs(this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a1aaae385ccca7c02f4ed88b510063c27">getBestPosition</a>().getPosition(i) - this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#ae67a14bbe108cf5e6d1d45ce23923b91">getNeighborhood</a>()-&gt;getBest()-&gt;getPosition(i));
<a name="l01123"></a>01123                 this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#af5af1fff27bfe5156633acb8e0f8acdf">setVelocity</a>(i, <a class="code" href="namespacepopot_1_1math.html#a379cb433fc4a216e75252d7278c161a7">popot::math::normal</a>(mean,var));
<a name="l01124"></a>01124               }
<a name="l01125"></a>01125           }
<a name="l01126"></a>01126         };
<a name="l01127"></a>01127 
<a name="l01136"></a>01136       <span class="keyword">template</span>&lt; <span class="keyword">typename</span> PROBLEM , <span class="keyword">typename</span> POSITION_INITIALIZER=popot::PSO::initializer::PositionUniformRandom, <span class="keyword">typename</span> VELOCITY_INITIALIZER=popot::PSO::initializer::VelocityHalfDiff&gt;
<a name="l01137"></a>01137         <span class="keyword">class </span>ModifiedBareboneParticle : <span class="keyword">public</span> Particle&lt;PROBLEM, POSITION_INITIALIZER, VELOCITY_INITIALIZER&gt;
<a name="l01138"></a>01138         {
<a name="l01139"></a>01139           <span class="keyword">typedef</span> Particle&lt;PROBLEM, POSITION_INITIALIZER, VELOCITY_INITIALIZER&gt; TSuper;
<a name="l01140"></a>01140         
<a name="l01141"></a>01141         <span class="keyword">public</span>:
<a name="l01142"></a>01142 
<a name="l01143"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1ModifiedBareboneParticle.html#aa50e7d20fb338b02f0c3b85c43e24497">01143</a>         <a class="code" href="classpopot_1_1PSO_1_1particle_1_1ModifiedBareboneParticle.html#aa50e7d20fb338b02f0c3b85c43e24497">ModifiedBareboneParticle</a>(<span class="keywordtype">void</span>) : <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>()
<a name="l01144"></a>01144             {
<a name="l01145"></a>01145             }
<a name="l01146"></a>01146 
<a name="l01150"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1ModifiedBareboneParticle.html#a7db2d3b0c226eaf8dd81164b46dbec40">01150</a>           <span class="keyword">virtual</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1ModifiedBareboneParticle.html#a7db2d3b0c226eaf8dd81164b46dbec40">~ModifiedBareboneParticle</a>(<span class="keywordtype">void</span>)
<a name="l01151"></a>01151             {
<a name="l01152"></a>01152             }
<a name="l01153"></a>01153 
<a name="l01157"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1ModifiedBareboneParticle.html#a43626b6655d03540891b8384ca499375">01157</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1ModifiedBareboneParticle.html#a43626b6655d03540891b8384ca499375">updatePosition</a>(<span class="keywordtype">void</span>)
<a name="l01158"></a>01158           {
<a name="l01159"></a>01159             <span class="comment">// Here it is simply : p_{k+1} = v_{k+1}</span>
<a name="l01160"></a>01160             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l01161"></a>01161               this-&gt;setPosition(i, this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#afae4802e0e1ebe2e9396671f48513d10">getVelocity</a>(i));
<a name="l01162"></a>01162           }
<a name="l01163"></a>01163 
<a name="l01167"></a><a class="code" href="classpopot_1_1PSO_1_1particle_1_1ModifiedBareboneParticle.html#ab66dfdc1fc989997c4e5a182d9d0e0ab">01167</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1PSO_1_1particle_1_1ModifiedBareboneParticle.html#ab66dfdc1fc989997c4e5a182d9d0e0ab">updateVelocity</a>(<span class="keywordtype">void</span>)
<a name="l01168"></a>01168           {
<a name="l01169"></a>01169             <span class="comment">// The update of the velocity is done according to the equation :</span>
<a name="l01170"></a>01170             <span class="comment">// v_{k+1} = N( (best_p+best_g)/2), sigma)</span>
<a name="l01171"></a>01171             <span class="comment">// with :</span>
<a name="l01172"></a>01172             <span class="comment">// sigma : the variance defined as |best_p_ij - best_g_ij| with</span>
<a name="l01173"></a>01173             <span class="comment">// best_p : the best position the particle ever had</span>
<a name="l01174"></a>01174             <span class="comment">// best_g : the best position the neighborhood ever had</span>
<a name="l01175"></a>01175             <span class="keywordtype">double</span> mean,var;
<a name="l01176"></a>01176                 
<a name="l01177"></a>01177             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; <a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html">TSuper</a>::_dimension ; ++i)
<a name="l01178"></a>01178               {
<a name="l01179"></a>01179                 <span class="keywordflow">if</span>(<a class="code" href="namespacepopot_1_1math.html#aff66c3835eec2f4653b273e25e8c841b">popot::math::uniform_random</a>(0.0,1.0) &lt; 0.5)
<a name="l01180"></a>01180                   {
<a name="l01181"></a>01181                     this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#af5af1fff27bfe5156633acb8e0f8acdf">setVelocity</a>(i, this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a1aaae385ccca7c02f4ed88b510063c27">getBestPosition</a>().getPosition(i));
<a name="l01182"></a>01182                   }
<a name="l01183"></a>01183                 <span class="keywordflow">else</span>
<a name="l01184"></a>01184                   {
<a name="l01185"></a>01185                     mean = 0.5*(this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a1aaae385ccca7c02f4ed88b510063c27">getBestPosition</a>().<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a7612290063de657dafec99cb35ee4032">getPosition</a>(i) + this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#ae67a14bbe108cf5e6d1d45ce23923b91">getNeighborhood</a>()-&gt;<a class="code" href="classpopot_1_1PSO_1_1neighborhood_1_1Neighborhood.html#a252939087d94296da4422bd5b6d22f85">getBest</a>()-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1BaseParticle.html#a7612290063de657dafec99cb35ee4032">getPosition</a>(i));
<a name="l01186"></a>01186                     var = fabs(this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#a1aaae385ccca7c02f4ed88b510063c27">getBestPosition</a>().getPosition(i) - this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#ae67a14bbe108cf5e6d1d45ce23923b91">getNeighborhood</a>()-&gt;getBest()-&gt;getPosition(i));
<a name="l01187"></a>01187                     this-&gt;<a class="code" href="classpopot_1_1PSO_1_1particle_1_1Particle.html#af5af1fff27bfe5156633acb8e0f8acdf">setVelocity</a>(i, <a class="code" href="namespacepopot_1_1math.html#a379cb433fc4a216e75252d7278c161a7">popot::math::normal</a>(mean,var));
<a name="l01188"></a>01188                   }
<a name="l01189"></a>01189               }
<a name="l01190"></a>01190           }
<a name="l01191"></a>01191         }; <span class="comment">// Modified Barebone</span>
<a name="l01192"></a>01192     } <span class="comment">// namespace particle</span>
<a name="l01193"></a>01193   } <span class="comment">// namespace PSO</span>
<a name="l01194"></a>01194 
<a name="l01195"></a>01195   <span class="comment">// Artificial Bee Colony</span>
<a name="l01196"></a>01196   <span class="keyword">namespace </span>ABC
<a name="l01197"></a>01197   {
<a name="l01198"></a><a class="code" href="namespacepopot_1_1ABC_1_1individuals.html">01198</a>     <span class="keyword">namespace </span>individuals
<a name="l01199"></a>01199     {
<a name="l01200"></a>01200       
<a name="l01201"></a>01201       <span class="keyword">template</span>&lt; <span class="keyword">typename</span> PROBLEM&gt;
<a name="l01202"></a>01202         <span class="keyword">class </span><a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html">FoodSource</a> : <span class="keyword">public</span> <a class="code" href="classpopot_1_1Vector.html" title="The template parameters are the type of values (e.g. double, or bool) and the dimension of the vector...">Vector</a>&lt;double, PROBLEM::nb_parameters&gt;
<a name="l01203"></a>01203         {
<a name="l01204"></a>01204           <span class="keyword">typedef</span> <a class="code" href="classpopot_1_1Vector.html">Vector&lt;double, PROBLEM::nb_parameters&gt;</a> TVector;
<a name="l01205"></a>01205 
<a name="l01206"></a>01206         <span class="keyword">private</span>:
<a name="l01207"></a>01207           <span class="keywordtype">double</span> fitness;
<a name="l01208"></a>01208           <span class="keywordtype">double</span> fvalue;
<a name="l01209"></a>01209           <span class="keywordtype">int</span> counter;
<a name="l01210"></a>01210 
<a name="l01211"></a>01211         <span class="keyword">public</span>:
<a name="l01212"></a><a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a86aef60828a00fb5ceb2ccf0663a594d">01212</a>         <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a86aef60828a00fb5ceb2ccf0663a594d">FoodSource</a>(<span class="keywordtype">void</span>): <a class="code" href="classpopot_1_1Vector.html">TVector</a>()
<a name="l01213"></a>01213             {}
<a name="l01214"></a>01214 
<a name="l01218"></a><a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#ad4aeaed009cd9d5a62ae35fac28f9771">01218</a>         <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a86aef60828a00fb5ceb2ccf0663a594d">FoodSource</a>(<span class="keyword">const</span> <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html">FoodSource</a> &amp; other) : <a class="code" href="classpopot_1_1Vector.html">TVector</a>(other), fitness(other.fitness), fvalue(other.fvalue), counter(other.counter)
<a name="l01219"></a>01219             {
<a name="l01220"></a>01220             }
<a name="l01221"></a>01221 
<a name="l01222"></a><a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a7fdf76dfe2ab96ff9e085ee0d66efb0a">01222</a>           <span class="keyword">virtual</span> <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a7fdf76dfe2ab96ff9e085ee0d66efb0a">~FoodSource</a>(<span class="keywordtype">void</span>)
<a name="l01223"></a>01223             {}
<a name="l01224"></a>01224 
<a name="l01225"></a><a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a02698e7d889a38b8df860c96137cfe9f">01225</a>           <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a02698e7d889a38b8df860c96137cfe9f">init</a>(<span class="keywordtype">void</span>)
<a name="l01226"></a>01226           {
<a name="l01227"></a>01227             <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0 ; i &lt; PROBLEM::nb_parameters ; ++i)
<a name="l01228"></a>01228               this-&gt;<a class="code" href="classpopot_1_1Vector.html#a1df5ea1f345af90326a85e566b25d0e5">setValueAt</a>(i, <a class="code" href="namespacepopot_1_1math.html#aff66c3835eec2f4653b273e25e8c841b">popot::math::uniform_random</a>(PROBLEM::get_lbound(i), PROBLEM::get_ubound(i)));
<a name="l01229"></a>01229 
<a name="l01230"></a>01230             <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a3b8e5de3157d0fe3cf59fae345adc545">computeFitness</a>();
<a name="l01231"></a>01231 
<a name="l01232"></a>01232             <span class="comment">// Initialize the counter</span>
<a name="l01233"></a>01233             counter = 0;
<a name="l01234"></a>01234           }
<a name="l01235"></a>01235 
<a name="l01236"></a><a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a502c2e1115840ee5cbe9626930449184">01236</a>           <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a502c2e1115840ee5cbe9626930449184">combine</a>(<span class="keyword">const</span> <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html">FoodSource</a> &amp; other_source)
<a name="l01237"></a>01237           {
<a name="l01238"></a>01238             <span class="comment">// Combination operator</span>
<a name="l01239"></a>01239             <span class="keywordtype">int</span> change_dim;
<a name="l01240"></a>01240             <span class="keywordtype">double</span> phi;
<a name="l01241"></a>01241             <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html">FoodSource</a> new_source;
<a name="l01242"></a>01242             <span class="keywordtype">double</span> new_param_value;
<a name="l01243"></a>01243 
<a name="l01244"></a>01244             <span class="comment">// Randomly select a dimension to change</span>
<a name="l01245"></a>01245             change_dim = (int) <a class="code" href="namespacepopot_1_1math.html#aff66c3835eec2f4653b273e25e8c841b">popot::math::uniform_random</a>(0, PROBLEM::nb_parameters);
<a name="l01246"></a>01246           
<a name="l01247"></a>01247             <span class="comment">// Random combination coefficient</span>
<a name="l01248"></a>01248             phi = <a class="code" href="namespacepopot_1_1math.html#aff66c3835eec2f4653b273e25e8c841b">popot::math::uniform_random</a>(-1.0, 1.0);
<a name="l01249"></a>01249 
<a name="l01250"></a>01250             <span class="comment">// Compute the new source</span>
<a name="l01251"></a>01251             new_source = *<span class="keyword">this</span>;
<a name="l01252"></a>01252             new_param_value = this-&gt;<a class="code" href="classpopot_1_1Vector.html#aefbef7f1d1b43f53aac6e2d717feb618">getValueAt</a>(change_dim) + phi * (this-&gt;<a class="code" href="classpopot_1_1Vector.html#aefbef7f1d1b43f53aac6e2d717feb618">getValueAt</a>(change_dim) - other_source.<a class="code" href="classpopot_1_1Vector.html#aefbef7f1d1b43f53aac6e2d717feb618">getValueAt</a>(change_dim));
<a name="l01253"></a>01253 
<a name="l01254"></a>01254             <span class="comment">// Bound the parameter value</span>
<a name="l01255"></a>01255             <span class="keywordflow">if</span>(new_param_value &lt; PROBLEM::get_lbound(change_dim))
<a name="l01256"></a>01256               new_param_value = PROBLEM::get_lbound(change_dim);
<a name="l01257"></a>01257             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(new_param_value &gt; PROBLEM::get_ubound(change_dim))
<a name="l01258"></a>01258               new_param_value = PROBLEM::get_ubound(change_dim);
<a name="l01259"></a>01259           
<a name="l01260"></a>01260             new_source.<a class="code" href="classpopot_1_1Vector.html#a1df5ea1f345af90326a85e566b25d0e5">setValueAt</a>(change_dim, new_param_value);
<a name="l01261"></a>01261 
<a name="l01262"></a>01262             <span class="comment">// Evaluate the fitness of the new solution</span>
<a name="l01263"></a>01263             new_source.<a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a3b8e5de3157d0fe3cf59fae345adc545">computeFitness</a>();
<a name="l01264"></a>01264 
<a name="l01265"></a>01265             <span class="comment">// Perform a greedy selection</span>
<a name="l01266"></a>01266             <span class="keywordflow">if</span>(new_source.<a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a57d40e8ec95c358fd49d18dd7952dd07">getFitness</a>() &gt; <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a57d40e8ec95c358fd49d18dd7952dd07">getFitness</a>())
<a name="l01267"></a>01267               {
<a name="l01268"></a>01268                 <span class="comment">// If we get a better solution, it takes the place of the previous one</span>
<a name="l01269"></a>01269                 *<span class="keyword">this</span> = new_source;
<a name="l01270"></a>01270                 <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#aa2f74d79de105b350f2f86fd58542a5b">resetCounter</a>();
<a name="l01271"></a>01271               }
<a name="l01272"></a>01272             <span class="keywordflow">else</span>
<a name="l01273"></a>01273               {
<a name="l01274"></a>01274                 <span class="comment">// otherwise we increment its counter</span>
<a name="l01275"></a>01275                 (*this)++;
<a name="l01276"></a>01276               }
<a name="l01277"></a>01277           }
<a name="l01278"></a>01278 
<a name="l01279"></a><a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#aa2f74d79de105b350f2f86fd58542a5b">01279</a>           <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#aa2f74d79de105b350f2f86fd58542a5b">resetCounter</a>(<span class="keywordtype">void</span>)
<a name="l01280"></a>01280           {
<a name="l01281"></a>01281             counter = 0;
<a name="l01282"></a>01282           }
<a name="l01283"></a>01283 
<a name="l01284"></a>01284 
<a name="l01285"></a><a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a6551824689832086eb0e382dd6fd5a6c">01285</a>           <span class="keywordtype">int</span> <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a6551824689832086eb0e382dd6fd5a6c">getCounter</a>(<span class="keywordtype">void</span>)
<a name="l01286"></a>01286           {
<a name="l01287"></a>01287             <span class="keywordflow">return</span> counter;
<a name="l01288"></a>01288           }
<a name="l01289"></a>01289 
<a name="l01290"></a><a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a4886f6e69fb53d4a88cfa335a5aad38b">01290</a>           <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a4886f6e69fb53d4a88cfa335a5aad38b">operator++</a>(<span class="keywordtype">int</span>) { 
<a name="l01291"></a>01291             counter ++;
<a name="l01292"></a>01292           }
<a name="l01293"></a>01293 
<a name="l01294"></a><a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a3b8e5de3157d0fe3cf59fae345adc545">01294</a>           <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a3b8e5de3157d0fe3cf59fae345adc545">computeFitness</a>(<span class="keywordtype">void</span>)
<a name="l01295"></a>01295           {
<a name="l01296"></a>01296             <span class="comment">// Compute the fitness</span>
<a name="l01297"></a>01297             fvalue = PROBLEM::evaluate(this-&gt;<a class="code" href="classpopot_1_1Vector.html#aa74fc0320c51efea093baeafb62a9c21">getValuesPtr</a>());
<a name="l01298"></a>01298             fitness = <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a297f0bcb60c8325b5c1a187577f2debd">fitnessFunction</a>(fvalue);
<a name="l01299"></a>01299           }
<a name="l01300"></a>01300 
<a name="l01301"></a><a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a297f0bcb60c8325b5c1a187577f2debd">01301</a>           <span class="keywordtype">double</span> <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a297f0bcb60c8325b5c1a187577f2debd">fitnessFunction</a>(<span class="keywordtype">double</span> x)
<a name="l01302"></a>01302           {
<a name="l01303"></a>01303             <span class="keywordflow">if</span>(x &gt;= 0.0)
<a name="l01304"></a>01304               <span class="keywordflow">return</span> 1.0 / (1.0 + x);
<a name="l01305"></a>01305             <span class="keywordflow">else</span>
<a name="l01306"></a>01306               <span class="keywordflow">return</span> 1.0 + fabs(x);
<a name="l01307"></a>01307           }
<a name="l01308"></a>01308 
<a name="l01309"></a><a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a57d40e8ec95c358fd49d18dd7952dd07">01309</a>           <span class="keywordtype">double</span> <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a57d40e8ec95c358fd49d18dd7952dd07">getFitness</a>(<span class="keywordtype">void</span>)
<a name="l01310"></a>01310           {
<a name="l01311"></a>01311             <span class="keywordflow">return</span> fitness;
<a name="l01312"></a>01312           }
<a name="l01313"></a>01313 
<a name="l01314"></a><a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a5ced1dda1140e9afb922d959499540d7">01314</a>           <span class="keywordtype">double</span> <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a5ced1dda1140e9afb922d959499540d7">getFValue</a>(<span class="keywordtype">void</span>)
<a name="l01315"></a>01315           {
<a name="l01316"></a>01316             <span class="keywordflow">return</span> fvalue;
<a name="l01317"></a>01317           }
<a name="l01318"></a>01318 
<a name="l01319"></a><a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#abf22131db51e548dddcfdf8b0a205c54">01319</a>           <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#abf22131db51e548dddcfdf8b0a205c54">print</a>(std::ostream &amp; os)<span class="keyword"> const</span>
<a name="l01320"></a>01320 <span class="keyword">          </span>{
<a name="l01321"></a>01321             <a class="code" href="classpopot_1_1Vector.html#a6d3cb96a58935fafa1020b7b5704effe">TVector::print</a>(os);
<a name="l01322"></a>01322             os &lt;&lt; <span class="stringliteral">&quot; Fitness : &quot;</span> &lt;&lt; fitness &lt;&lt; <span class="stringliteral">&quot; Fvalue : &quot;</span> &lt;&lt; fvalue &lt;&lt; <span class="stringliteral">&quot; Count : &quot;</span> &lt;&lt; counter;
<a name="l01323"></a>01323           }
<a name="l01324"></a>01324 
<a name="l01328"></a><a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a48530294f7ef77dea9d3b331aa09599d">01328</a>           <span class="keyword">friend</span> std::ostream &amp; <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#a48530294f7ef77dea9d3b331aa09599d">operator &lt;&lt;</a>(std::ostream &amp; os, <span class="keyword">const</span> <a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html">FoodSource</a> &amp;b)
<a name="l01329"></a>01329           {
<a name="l01330"></a>01330             b.<a class="code" href="classpopot_1_1ABC_1_1individuals_1_1FoodSource.html#abf22131db51e548dddcfdf8b0a205c54">print</a>(os);
<a name="l01331"></a>01331             <span class="keywordflow">return</span> os;
<a name="l01332"></a>01332           }
<a name="l01333"></a>01333 
<a name="l01334"></a>01334         }; <span class="comment">// FoodSource     </span>
<a name="l01335"></a>01335     } <span class="comment">// namespace individuals</span>
<a name="l01336"></a>01336 
<a name="l01337"></a>01337   } <span class="comment">// namespace ABC</span>
<a name="l01338"></a>01338 
<a name="l01339"></a>01339 }<span class="comment">//namespace popot</span>
<a name="l01340"></a>01340 
<a name="l01341"></a>01341 <span class="preprocessor">#endif // POPOT_INDIVIDUALS_H</span>
</pre></div></div>
</div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Defines</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.5
</small></address>

</body>
</html>
